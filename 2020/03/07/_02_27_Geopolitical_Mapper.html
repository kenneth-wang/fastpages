<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" type="image/x-icon" href="/fastpages/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Mapping the world | Kenneth Wang</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Mapping the world" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Sentiment analysis of geopolitical relations using ALBERT" />
<meta property="og:description" content="Sentiment analysis of geopolitical relations using ALBERT" />
<link rel="canonical" href="https://kenneth-wang.github.io/fastpages/2020/03/07/_02_27_Geopolitical_Mapper.html" />
<meta property="og:url" content="https://kenneth-wang.github.io/fastpages/2020/03/07/_02_27_Geopolitical_Mapper.html" />
<meta property="og:site_name" content="Kenneth Wang" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-03-07T00:00:00-06:00" />
<script type="application/ld+json">
{"description":"Sentiment analysis of geopolitical relations using ALBERT","@type":"BlogPosting","headline":"Mapping the world","dateModified":"2020-03-07T00:00:00-06:00","datePublished":"2020-03-07T00:00:00-06:00","url":"https://kenneth-wang.github.io/fastpages/2020/03/07/_02_27_Geopolitical_Mapper.html","mainEntityOfPage":{"@type":"WebPage","@id":"https://kenneth-wang.github.io/fastpages/2020/03/07/_02_27_Geopolitical_Mapper.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  <link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
  <link rel="stylesheet" href="/fastpages/assets/main.css">
  <link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://kenneth-wang.github.io/fastpages/feed.xml" title="Kenneth Wang" /><!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-159230443-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>



  <script>
  function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
  }
  window.onload = wrap_img;
  </script>

  <script>
    document.addEventListener("DOMContentLoaded", function(){
      // add link icon to anchor tags
      var elem = document.querySelectorAll(".anchor-link")
      elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
      // remove paragraph tags in rendered toc (happens from notebooks)
      var toctags = document.querySelectorAll(".toc-entry")
      toctags.forEach(e => (e.firstElementChild.innerText = e.firstElementChild.innerText.replace('¶', '')))
    });
  </script>
</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/fastpages/">Kenneth Wang</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/fastpages/about/">About me</a><a class="page-link" href="/fastpages/search/">Search</a><a class="page-link" href="/fastpages/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header"><h1 class="post-title p-name" itemprop="name headline">Mapping the world</h1><p class="page-description">Sentiment analysis of geopolitical relations using ALBERT</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-03-07T00:00:00-06:00" itemprop="datePublished">
        Mar 7, 2020
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      43 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">
<a href="https://github.com/kenneth-wang/fastpages/tree/master/_notebooks/2020_02_27_Geopolitical_Mapper.ipynb" role="button">
    <img class="notebook-badge-image" src="https://img.shields.io/static/v1?label=&message=View%20On%20GitHub&color=586069&logo=github&labelColor=2f363d">
</a>
</div><div class="px-2">
    <a href="https://colab.research.google.com/github/kenneth-wang/fastpages/blob/master/_notebooks/2020_02_27_Geopolitical_Mapper.ipynb">
        <img class="notebook-badge-image" src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020_02_27_Geopolitical_Mapper.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It feels like the stock market tend to move in tandem with the political headlines. Benjamin Graham, the father of value investing once quoted <strong>"In the short run, the market is a voting machine but in the long run, it is a weighting machine."</strong> I'm sure you have witnessed headlines such as the following:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>Dow ends down 2.4% on escalating US-China trade war</em></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Being able to sift through the noise in the headlines could make the media an unexpected ally for investing. Unsurprisingly, in response to demand for such forms of alternative data, <a href="https://www.bloomberg.com/professional/sentiment-analysis-white-papers/">Bloomberg</a> introduced a tool to generate sentiments from news and social media data. In this blog post, we'll walk through the steps to analyze text data and <strong>generate sentiments out of the relationships between countries by using ALBERT</strong>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="What-is-ALBERT?">What is ALBERT?<a class="anchor-link" href="#What-is-ALBERT?"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/fastpages/images/copied_from_nb/my_icons/geopolitical_mapper/bert_cropped.JPG" alt="" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Ok what is <strong>ALBERT</strong> exactly? ALBERT stands for "A Lite BERT For Self-Supervised Learning of Language Representations". ALBERT was introduced by Google as a <strong>newly improved version of BERT</strong>, or Bidirectional Encoder Representations with Transformers. It achieved state-of-the art results on three popular benchmark tests for nautral language understanding (GLUE, SQUAD and RACE). ALBERT improves on BERT by:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><strong>utilizing factorized embedding parametrization</strong>.
From a language modelling perspective, input-level embeddings are context-independent representations of the words (eg. "bank"), whereas the hidden-layer embeddings are meant to learn context-dependent representations (eg. "bank" in the context of financial transactions or river-flow management). Traditionally the sizes of the input-level and hidden layer embeddings are the same and pegged to one another. ALBERT takes a different approach by reducing the size of the input-level embeddings (128), while keeping hidden-layer embeddings at a higher dimension (768). With this, ALBERT managed to reduce the number of parameters drastically at the expense of a minor drop in performance.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><strong>implementing cross-layer parameter sharing</strong>.
The authors implemented cross-layer parameter (feed-forward network parameters and attention parameters) sharing and results show that weight-sharing has an effect on stabilizing network parameters. As shown below, the differences (L2/ Cosine Similarity measures) between the input and output embeddings for ALBERT do not fluctuate as vigorously when compared to BERT.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/fastpages/images/copied_from_nb/my_icons/geopolitical_mapper/albert_cross_layer.JPG" alt="" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><strong>making amendments to the Sentence Order Prediction (SOP) training task</strong>. During the training phase, BERT receives two sentences each time and it needs to predict whether the second sentence in the pair, has been swapped with a sentence <strong>from another document</strong>. ALBERT implements a similar methodolgy, however it chooses instead to predict whether the order of two consecutive sentences <strong>in the same document</strong>, have been swapped. The authors felt that the task of predicting the order of sentences is a more challenging pretraining task.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Due to the design choices of the authors, the ALBERT models have a <strong>smaller set of parameters</strong>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/fastpages/images/copied_from_nb/my_icons/geopolitical_mapper/albert_parameters.JPG" alt="" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Project-directory-structure">Project directory structure<a class="anchor-link" href="#Project-directory-structure"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The files that we will be referring to can be found <a href="https://drive.google.com/open?id=1P6vzA168DovwZGtTD5OnYCMB-jTGlAdL">here</a>. You can refer to the project structure below to find the locations of the files we need. We will be using <strong>SQUAD's SST-2</strong> dataset to finetune the ALBERT model before using <strong>transfer learning</strong> to train on our own data. We will use <strong>Wikipedia's API</strong> to extract text data that outlines the relationships between countries.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">geopolitical_mapper</span><span class="o">/</span>

<span class="n">_______</span> <span class="n">data</span><span class="o">/</span>
<span class="n">___________</span> <span class="n">SST</span><span class="o">-</span><span class="mi">2</span><span class="o">/</span> <span class="c1"># SST-2 dataset</span>
<span class="n">___________</span> <span class="n">Wiki</span><span class="o">/</span> <span class="c1"># Wikipedia/ country-related data</span>
<span class="n">______________</span> <span class="n">countries</span><span class="o">.</span><span class="n">csv</span> <span class="c1"># list of countries in the world</span>
<span class="n">______________</span> <span class="n">country_ISO</span><span class="o">.</span><span class="n">txt</span> <span class="c1"># mapping of countries and their ISO code</span>
<span class="n">______________</span> <span class="n">wiki_relations</span><span class="o">.</span><span class="n">csv</span> <span class="c1"># wikipedia summaries of country relationships</span>
<span class="n">______________</span> <span class="n">dev</span><span class="o">.</span><span class="n">tsv</span> <span class="c1"># validation dataset </span>
<span class="n">______________</span> <span class="n">train</span><span class="o">.</span><span class="n">tsv</span> <span class="c1"># training dataset</span>
<span class="n">______________</span> <span class="n">sent_l_</span><span class="o">.</span><span class="n">csv</span> <span class="c1"># labeled dataset (without labels)</span>
<span class="n">______________</span> <span class="n">sent_ld</span><span class="o">.</span><span class="n">csv</span> <span class="c1"># labeled dataset (with labels)</span>
<span class="n">______________</span> <span class="n">sent_ul</span><span class="o">.</span><span class="n">csv</span> <span class="c1"># unlabeled dataset</span>

<span class="n">_______</span> <span class="n">model</span><span class="o">/</span> <span class="c1"># Finetuned ALBERT model weights and checkpoints</span>

<span class="n">_______</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">27</span><span class="o">-</span><span class="n">Geopolitical</span><span class="o">-</span><span class="n">Mapper</span><span class="o">.</span><span class="n">ipynb</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Requirements">Requirements<a class="anchor-link" href="#Requirements"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's start coding! Let's install the packages we need and import them.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="o">%%capture</span>

<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">bs4</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">plotly</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">requests</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">sklearn</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">spacy</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">tensorflow</span><span class="o">==</span><span class="mf">2.0</span><span class="o">.</span><span class="mi">0</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">tensorflow</span><span class="o">-</span><span class="n">gpu</span><span class="o">==</span><span class="mf">2.0</span><span class="o">.</span><span class="mi">0</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">transformers</span><span class="o">==</span><span class="mf">2.3</span><span class="o">.</span><span class="mi">0</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">wikipedia</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="kn">import</span> <span class="nn">spacy</span>
<span class="kn">import</span> <span class="nn">urllib.request</span>
<span class="kn">import</span> <span class="nn">wikipedia</span>
<span class="kn">import</span> <span class="nn">zipfile</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">GroupShuffleSplit</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> \
                            <span class="n">accuracy_score</span>
                            
<span class="kn">from</span> <span class="nn">spacy.lang.en</span> <span class="kn">import</span> <span class="n">English</span>
<span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">AlbertTokenizer</span><span class="p">,</span> <span class="n">glue_convert_examples_to_features</span>
<span class="kn">from</span> <span class="nn">transformers.data.processors</span> <span class="kn">import</span> <span class="n">utils</span>
<span class="kn">from</span> <span class="nn">transformers.modeling_tf_albert</span> <span class="kn">import</span> <span class="n">TFAlbertForSequenceClassification</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.callbacks</span> <span class="kn">import</span> <span class="n">ReduceLROnPlateau</span><span class="p">,</span> <span class="n">ModelCheckpoint</span><span class="p">,</span> \
                                       <span class="n">EarlyStopping</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If you are running the notebook using Google Colab, remember to mount the directory that you are working from.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="o">%%capture</span>

<span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/gdrive/&#39;</span><span class="p">)</span>

<span class="o">%</span><span class="n">cd</span> <span class="o">/</span><span class="n">content</span><span class="o">/</span><span class="n">gdrive</span><span class="o">/</span><span class="n">My</span> <span class="n">Drive</span><span class="o">/</span><span class="n">Colab</span> <span class="n">Notebooks</span><span class="o">/</span><span class="n">ssh_files</span><span class="o">/</span><span class="n">geopolitical_mapper</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Go to this URL in a browser: https://accounts.google.com/o/oauth2/auth?client_id=947318989803-6bn6qk8qdgf4n4g3pfee6491hc0brc4i.apps.googleusercontent.com&amp;redirect_uri=urn%3aietf%3awg%3aoauth%3a2.0%3aoob&amp;response_type=code&amp;scope=email%20https%3a%2f%2fwww.googleapis.com%2fauth%2fdocs.test%20https%3a%2f%2fwww.googleapis.com%2fauth%2fdrive%20https%3a%2f%2fwww.googleapis.com%2fauth%2fdrive.photos.readonly%20https%3a%2f%2fwww.googleapis.com%2fauth%2fpeopleapi.readonly

Enter your authorization code:
··········
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Get-alternative-names-of-countries">Get alternative names of countries<a class="anchor-link" href="#Get-alternative-names-of-countries"> </a></h1><p>One of the biggest problems we face is that <strong>each country can have multiple naming conventions</strong>. For example, depending on the data that you use, <strong>"United States"</strong> might be named as <strong>"United States of America" or "USA"</strong>. Hence we need to look for a source that give us the different naming conventions for each of the countries. Thankfully we are able to source the names from a <a href="https://en.wikipedia.org/wiki/List_of_alternative_country_names">Wikipage</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/fastpages/images/copied_from_nb/my_icons/geopolitical_mapper/wikipedia_table.JPG" alt="" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Each of the tables in the Wikipage has two columns.</strong> The column on the left, lists down the "standardized names" of the countries in alphabetical order...</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">website_url</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;https://en.wikipedia.org/wiki/List_of_alternative_country_names&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>

<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">website_url</span><span class="p">,</span><span class="s1">&#39;lxml&#39;</span><span class="p">)</span>
<span class="n">tables</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;table&#39;</span><span class="p">,{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span><span class="s1">&#39;wikitable&#39;</span><span class="p">})</span>

<span class="n">countries</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1">## Left column - &quot;Description&quot;</span>
<span class="c1"># Each table contains countries that start with a certain alphabet</span>
<span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">tables</span><span class="p">:</span>
  <span class="n">rows</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;tr&#39;</span><span class="p">)</span>
  
  <span class="c1"># Gather countries with the specific alphabet</span>
  
  <span class="n">countries_alphabet</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">)</span> \
                        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">]</span>

  <span class="k">for</span> <span class="n">country</span> <span class="ow">in</span> <span class="n">countries_alphabet</span><span class="p">:</span>
    <span class="n">countries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">country</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>...while the columns on the right lists down the alternative names of the countries.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">countries_alt_names</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Right column - Other name(s) or older name(s)</span>
<span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">tables</span><span class="p">:</span>
  <span class="n">rows</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;tr&#39;</span><span class="p">)</span>

  <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
    
    <span class="c1"># Exclude table headers</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">country_alt_name</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span><span class="o">.</span><span class="n">text</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)]</span>
      
      <span class="k">if</span> <span class="n">country_alt_name</span><span class="p">:</span>
        <span class="n">countries_alt_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">country_alt_name</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>After scrapping the table from the Wikipage, we can <strong>create a dictionary</strong> <code>alt_names_to_countries</code> that maps each alternative name of the countries to their standardized name. (eg. "USA": "United States"). In the process of doing so we will:</p>
<ul>
<li>convert all letters to lower case</li>
<li>remove "the"</li>
<li>remove any empty spaces " ".</li>
</ul>
<p>With these changes, names such as <strong>"The United States of America"</strong> will be modified to <strong>"united_states_of_america"</strong>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="c1"># First we group each country with their respective alternative names</span>
<span class="n">countries_to_alt_names_raw</span> <span class="o">=</span> <span class="p">{</span><span class="n">c</span><span class="p">:</span><span class="n">n</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">countries</span><span class="p">,</span> <span class="n">countries_alt_names</span><span class="p">)}</span>

<span class="c1"># Map each alternative name to the default country name</span>
<span class="n">alt_names_to_countries</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">countries_to_alt_names_raw</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> \
                          <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))}</span>

<span class="c1"># We lowercase the names; Remove &quot;the&quot; and &#39;&#39; that are contained in the names</span>
<span class="n">alt_names_to_countries</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;the &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">):</span> <span class="n">v</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;the &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> \
                          <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">alt_names_to_countries</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

<span class="n">alt_names_to_countries</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">):</span> <span class="n">v</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span> \
                          <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">alt_names_to_countries</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We <strong>remove names that are empty strings</strong> and <strong>add some names</strong> that were missed out by the Wikipage.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="c1"># remove empty strings</span>
<span class="n">alt_names_to_countries</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="c1"># Add names</span>
<span class="n">alt_names_to_countries</span><span class="p">[</span><span class="s1">&#39;angola&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;angola&#39;</span>
<span class="n">alt_names_to_countries</span><span class="p">[</span><span class="s1">&#39;equatorial_guinea&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;equatorial_guinea&#39;</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <strong>mappings of standardized names with themselves</strong> are valid mappings as well. We'll add them in.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">default_countries</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">alt_names_to_countries</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">default_countries</span><span class="p">:</span>
  <span class="n">alt_names_to_countries</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">c</span><span class="p">:</span><span class="n">c</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's convert the dictionary <code>alt_names_to_countries</code> into a dataframe <code>alt_names_df</code> for easier visualization.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">alt_names_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">alt_names_to_countries</span><span class="p">,</span> \
                                      <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="n">alt_names_df</span> <span class="o">=</span> <span class="n">alt_names_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;Alternative_Name&#39;</span><span class="p">,</span> \
                                            <span class="mi">0</span><span class="p">:</span><span class="s1">&#39;Name&#39;</span><span class="p">})</span>

<span class="n">alt_names_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Alternative_Name</th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>republic_of_abkhazia</td>
      <td>abkhazia</td>
    </tr>
    <tr>
      <th>1</th>
      <td>aphsny_axwynthkharra</td>
      <td>abkhazia</td>
    </tr>
    <tr>
      <th>2</th>
      <td>respublika_abkhaziya</td>
      <td>abkhazia</td>
    </tr>
    <tr>
      <th>3</th>
      <td>autonomous_republic_of_abkhazia</td>
      <td>abkhazia</td>
    </tr>
    <tr>
      <th>4</th>
      <td>islamic_republic_of_afghanistan</td>
      <td>afghanistan</td>
    </tr>
    <tr>
      <th>5</th>
      <td>da_afġānistān_islāmī_jumhoryat</td>
      <td>afghanistan</td>
    </tr>
    <tr>
      <th>6</th>
      <td>jomhūrīyyeh_eslāmīyyeh_afġānestān</td>
      <td>afghanistan</td>
    </tr>
    <tr>
      <th>7</th>
      <td>republic_of_albania</td>
      <td>albania</td>
    </tr>
    <tr>
      <th>8</th>
      <td>republika_e_shqipërisë</td>
      <td>albania</td>
    </tr>
    <tr>
      <th>9</th>
      <td>arnavutluk</td>
      <td>albania</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As it will be easier for us to work with country names when they are standardized, let's <strong>create a function</strong> <code>get_std_names</code> that converts the raw names to the standardized (std) names by using the mappings in <code>alt_names_to_countries</code>. Sometimes raw names that we deal with may be upper cased or contain words/characters such as "the", brackets and punctuations. We will clean them up before looking for their standardized names.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="k">def</span> <span class="nf">get_std_names</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col_name</span><span class="p">,</span> <span class="n">alt_names_to_countries</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a new column of standardized country names for a dataframe</span>
<span class="sd">    </span>
<span class="sd">    args:</span>
<span class="sd">    ------</span>
<span class="sd">        df: (pd.DataFrame) initial dataframe</span>
<span class="sd">        col_name: (str) name of the column containing the raw country names </span>
<span class="sd">                        eg. &quot;Country_A&quot;</span>
<span class="sd">        alt_names_to_countries: (dict) contains country mappings</span>
<span class="sd">    Return:</span>
<span class="sd">    ------</span>
<span class="sd">        New dataframe with an additional column with the suffix &quot;_Std&quot; </span>
<span class="sd">        representing the standardized country names eg. &quot;Country_A_Std&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">country_names</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="c1"># lower case</span>
    <span class="n">country_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">country_names</span><span class="p">]</span>
    <span class="c1"># remove the</span>
    <span class="n">country_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;the &quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">country_names</span><span class="p">]</span>
    <span class="c1"># add underscore</span>
    <span class="n">country_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">country_names</span><span class="p">]</span>
    <span class="c1"># remove &#39;(&#39; &#39;)&#39;</span>
    <span class="n">country_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">country_names</span><span class="p">]</span>
    <span class="n">country_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">country_names</span><span class="p">]</span>
    <span class="c1"># remove .</span>
    <span class="n">country_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">country_names</span><span class="p">]</span>
    
    <span class="n">std_names</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">country_names</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="n">std_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">alt_names_to_countries</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
      <span class="k">except</span><span class="p">:</span>
        <span class="n">std_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="n">df</span><span class="p">[</span><span class="n">col_name</span> <span class="o">+</span> <span class="s1">&#39;_Std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">std_names</span>

    <span class="k">return</span> <span class="n">df</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Great, now let's put the <code>get_std_names</code> function to good use! As you can see, we have an <strong>additional column</strong> <code>Country_Std</code> that contains the standardized names.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">countries_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./data/Wiki/countries.csv&#39;</span><span class="p">)</span>

<span class="n">countries_df</span> <span class="o">=</span> <span class="n">get_std_names</span><span class="p">(</span><span class="n">countries_df</span><span class="p">,</span> <span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="n">alt_names_to_countries</span><span class="p">)</span>
<span class="n">countries_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Continent</th>
      <th>Country</th>
      <th>Country_Std</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Africa</td>
      <td>Algeria</td>
      <td>algeria</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Africa</td>
      <td>Angola</td>
      <td>angola</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Africa</td>
      <td>Benin</td>
      <td>benin</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Africa</td>
      <td>Botswana</td>
      <td>botswana</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Africa</td>
      <td>Burkina</td>
      <td>burkina</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Africa</td>
      <td>Burundi</td>
      <td>burundi</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Africa</td>
      <td>Cameroon</td>
      <td>cameroon</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Africa</td>
      <td>Cape Verde</td>
      <td>cape_verde</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Africa</td>
      <td>Central African Republic</td>
      <td>central_african_republic</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Africa</td>
      <td>Chad</td>
      <td>chad</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With the names of the countries all accounted for, we will gather the total number of pair-wise relations between countries that we have to analyze the sentiments for. We will grab a list of unique countries that we have, group them up and remove any duplicate pairs. And bam! We have <strong>18,336 country pairs</strong> that we have to work with.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">country_groups</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">unique_countries</span> <span class="o">=</span> <span class="n">countries_df</span><span class="p">[</span><span class="s1">&#39;Country_Std&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_countries</span><span class="p">)):</span>
  <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_countries</span><span class="p">)):</span>
    <span class="n">country_A</span> <span class="o">=</span> <span class="n">unique_countries</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">country_B</span> <span class="o">=</span> <span class="n">unique_countries</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>

    <span class="c1"># We are not interested in relations of countries with itself</span>
    <span class="k">if</span> <span class="n">country_A</span> <span class="o">!=</span> <span class="n">country_B</span><span class="p">:</span>
      <span class="n">country_groups</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">country_A</span><span class="p">,</span> <span class="n">country_B</span><span class="p">])</span>

<span class="c1"># Sort by alphabetical order</span>
<span class="n">sorted_country_groups</span> <span class="o">=</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">el</span><span class="p">))</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">country_groups</span><span class="p">]</span>

<span class="c1"># Remove any duplicates</span>
<span class="n">unique_country_groups</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">sorted_country_groups</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_country_groups</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">unique_country_groups</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>18336
[(&#39;algeria&#39;, &#39;angola&#39;), (&#39;algeria&#39;, &#39;benin&#39;), (&#39;algeria&#39;, &#39;botswana&#39;), (&#39;algeria&#39;, &#39;burkina&#39;), (&#39;algeria&#39;, &#39;burundi&#39;)]
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Gathering-the-data-from-Wikipedia!">Gathering the data from Wikipedia!<a class="anchor-link" href="#Gathering-the-data-from-Wikipedia!"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/fastpages/images/copied_from_nb/my_icons/geopolitical_mapper/singapore_china_relations.JPG" alt="" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To gather the data we need, one option will be to scrape news headlines from the web. But one of the problems that we face when doing a simple search with "China-United States relations" on Google is that you are <strong>unable to differentiate facts from commentaries</strong>. The following is a headline from CNN:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>The US-China trade war isn't getting better. This week showed why it could get worse.</em></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Including such headlines in our data could <strong>affect the reliability of our predictions.</strong> Thankfully we are able to find an alternative data source from Wikipedia that offers summaries of actual incidents that occured between countries. Here is an <strong>example for the relationship between United States and Singapore</strong> retrieved from the <a href="https://en.wikipedia.org/wiki/Singapore%E2%80%93United_States_relations"><strong>summary section of the Singapore-United States Relations wikipedia page</strong></a>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="c1"># Create empty dataframe</span>
<span class="n">wiki_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Summary&#39;</span><span class="p">,</span> <span class="s1">&#39;URL&#39;</span><span class="p">,</span> <span class="s1">&#39;Country_Pair&#39;</span><span class="p">])</span>


<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">unique_countries</span><span class="p">:</span>
  <span class="c1"># For each country, identify which country relations are </span>
  <span class="c1"># available on wikipedia</span>
  <span class="n">avail_relations</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="s2">&quot; relations&quot;</span><span class="p">)</span>

  <span class="c1"># For each available result</span>
  <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">wikipedia</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">avail_relations</span><span class="p">):</span>

      <span class="c1"># Filter out results are not related to the relations of countries</span>
      <span class="k">if</span> <span class="s2">&quot;–&quot;</span> <span class="ow">in</span> <span class="n">r</span> <span class="ow">and</span> <span class="s2">&quot;relations&quot;</span> <span class="ow">in</span> <span class="n">r</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
          <span class="c1"># Retrieve the summary paragraph on the wikipage</span>
          <span class="n">summary</span> <span class="o">=</span> <span class="n">wikipedia</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

          <span class="c1"># Retrieve the url</span>
          <span class="n">url</span> <span class="o">=</span> <span class="n">wikipedia</span><span class="o">.</span><span class="n">page</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">url</span>

          <span class="n">wiki_df</span> <span class="o">=</span> <span class="n">wiki_df</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;Summary&#39;</span><span class="p">:</span> <span class="n">summary</span><span class="p">,</span> <span class="s1">&#39;URL&#39;</span><span class="p">:</span> <span class="n">url</span><span class="p">,</span> \
                                    <span class="s1">&#39;Country_Pair&#39;</span><span class="p">:</span> <span class="n">r</span><span class="p">},</span><span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
          <span class="k">pass</span>

<span class="n">wiki_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;./data/Wiki/wiki_relations.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Unfortunately, Wikipedia does not cover all 18,336 pairs that we are interested in. We are only able to retrieve the information for <strong>1,463 pairs</strong>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">wiki_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./data/Wiki/wiki_relations.csv&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">wiki_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">wiki_df</span><span class="p">[[</span><span class="s1">&#39;Summary&#39;</span><span class="p">,</span> <span class="s1">&#39;URL&#39;</span><span class="p">,</span> <span class="s1">&#39;Country_Pair&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(1463, 3)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Summary</th>
      <th>URL</th>
      <th>Country_Pair</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Relations between France and Algeria span more...</td>
      <td>https://en.wikipedia.org/wiki/Algeria%E2%80%93...</td>
      <td>Algeria–France relations</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Algeria – United States relations are the inte...</td>
      <td>https://en.wikipedia.org/wiki/Algeria%E2%80%93...</td>
      <td>Algeria–United States relations</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Algeria–Libya relations are longstanding betwe...</td>
      <td>https://en.wikipedia.org/wiki/Algeria%E2%80%93...</td>
      <td>Algeria–Libya relations</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Algeria–Morocco relations have been dominated ...</td>
      <td>https://en.wikipedia.org/wiki/Algeria%E2%80%93...</td>
      <td>Algeria–Morocco relations</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Algeria–Turkey relations are foreign relations...</td>
      <td>https://en.wikipedia.org/wiki/Algeria%E2%80%93...</td>
      <td>Algeria–Turkey relations</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Algeria–Russia relations (Russian: Российско–а...</td>
      <td>https://en.wikipedia.org/wiki/Algeria%E2%80%93...</td>
      <td>Algeria–Russia relations</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Algeria–Israel relations refers to the current...</td>
      <td>https://en.wikipedia.org/wiki/Algeria%E2%80%93...</td>
      <td>Algeria–Israel relations</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Algeria–Indonesia relations refers to the bila...</td>
      <td>https://en.wikipedia.org/wiki/Algeria%E2%80%93...</td>
      <td>Algeria–Indonesia relations</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Algeria–China relations (also, Sino-Algerian r...</td>
      <td>https://en.wikipedia.org/wiki/Algeria%E2%80%93...</td>
      <td>Algeria–China relations</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Angola – United States relations are diplomati...</td>
      <td>https://en.wikipedia.org/wiki/Angola%E2%80%93U...</td>
      <td>Angola–United States relations</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Some of the summaries that we have retrieved from Wikipedia were <strong>empty strings</strong>. Let's remove them.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">wiki_df</span> <span class="o">=</span> <span class="n">wiki_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;EMPTY&quot;</span><span class="p">)</span>
<span class="n">wiki_df</span> <span class="o">=</span> <span class="n">wiki_df</span><span class="p">[</span><span class="n">wiki_df</span><span class="p">[</span><span class="s1">&#39;Summary&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;EMPTY&quot;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's split the pairs in <code>Country_Pairs</code> into their <strong>constituent countries</strong> and place them in separate columns <code>Country_A</code> and <code>Country_B</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="k">def</span> <span class="nf">split_country_pair</span><span class="p">(</span><span class="n">wiki_country_pairs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Split country_pairs found via wikipedia (eg. &quot;Algebria-France relations&quot;)</span>
<span class="sd">    </span>
<span class="sd">    args:</span>
<span class="sd">    ------</span>
<span class="sd">        wiki_country_pairs: (list) country_pairs to be split</span>
<span class="sd">    Return:</span>
<span class="sd">    ------</span>
<span class="sd">        countries_A: (list) countries on the left of &quot;-&quot; separator</span>
<span class="sd">        countries_B: (list) countries on the right of &quot;-&quot; separator</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">country_pairs</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; relations&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">wiki_country_pairs</span><span class="p">]</span>
    <span class="n">countries_A</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;–&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">country_pairs</span><span class="p">]</span>
    <span class="n">countries_B</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;–&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">country_pairs</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">countries_A</span> <span class="p">,</span> <span class="n">countries_B</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">wiki_df</span><span class="p">[</span><span class="s1">&#39;Country_A&#39;</span><span class="p">],</span> <span class="n">wiki_df</span><span class="p">[</span><span class="s1">&#39;Country_B&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">split_country_pair</span><span class="p">(</span><span class="n">wiki_df</span><span class="p">[</span><span class="s1">&#39;Country_Pair&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With the country pairs separated we can retrieve their standardized <code>std</code> names. Remember the <code>get_std_names</code> function that we created earlier?</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">wiki_df</span> <span class="o">=</span> <span class="n">get_std_names</span><span class="p">(</span><span class="n">wiki_df</span><span class="p">,</span> <span class="s1">&#39;Country_A&#39;</span><span class="p">,</span> <span class="n">alt_names_to_countries</span><span class="p">)</span>
<span class="n">wiki_df</span> <span class="o">=</span> <span class="n">get_std_names</span><span class="p">(</span><span class="n">wiki_df</span><span class="p">,</span> <span class="s1">&#39;Country_B&#39;</span><span class="p">,</span> <span class="n">alt_names_to_countries</span><span class="p">)</span>

<span class="n">wiki_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Summary</th>
      <th>URL</th>
      <th>Country_Pair</th>
      <th>Country_A</th>
      <th>Country_B</th>
      <th>Country_A_Std</th>
      <th>Country_B_Std</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Relations between France and Algeria span more...</td>
      <td>https://en.wikipedia.org/wiki/Algeria%E2%80%93...</td>
      <td>Algeria–France relations</td>
      <td>Algeria</td>
      <td>France</td>
      <td>algeria</td>
      <td>france</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Algeria – United States relations are the inte...</td>
      <td>https://en.wikipedia.org/wiki/Algeria%E2%80%93...</td>
      <td>Algeria–United States relations</td>
      <td>Algeria</td>
      <td>United States</td>
      <td>algeria</td>
      <td>united_states</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Algeria–Libya relations are longstanding betwe...</td>
      <td>https://en.wikipedia.org/wiki/Algeria%E2%80%93...</td>
      <td>Algeria–Libya relations</td>
      <td>Algeria</td>
      <td>Libya</td>
      <td>algeria</td>
      <td>libya</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Algeria–Morocco relations have been dominated ...</td>
      <td>https://en.wikipedia.org/wiki/Algeria%E2%80%93...</td>
      <td>Algeria–Morocco relations</td>
      <td>Algeria</td>
      <td>Morocco</td>
      <td>algeria</td>
      <td>morocco</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Algeria–Turkey relations are foreign relations...</td>
      <td>https://en.wikipedia.org/wiki/Algeria%E2%80%93...</td>
      <td>Algeria–Turkey relations</td>
      <td>Algeria</td>
      <td>Turkey</td>
      <td>algeria</td>
      <td>turkey</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Generate-labeled-data-for-training">Generate labeled data for training<a class="anchor-link" href="#Generate-labeled-data-for-training"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/fastpages/images/copied_from_nb/my_icons/geopolitical_mapper/google_machine_learning_code.gif" alt="" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Creating your own <strong>training dataset</strong> is one of the most challenging task in the real world. To finetune ALBERT for our use case, we will need to create a training dataset.</p>
<p>Due to time limitations, <strong>let's label 10% of the data</strong> <code>l</code> while the <strong>remaining 90% of the data will remain unlabeled</strong> <code>ul</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">wiki_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

<span class="n">X_l</span><span class="p">,</span> <span class="n">X_ul</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="mf">0.10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">wiki_l_df</span> <span class="o">=</span> <span class="n">wiki_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">X_l</span><span class="p">]</span>
<span class="n">wiki_ul_df</span> <span class="o">=</span> <span class="n">wiki_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">X_ul</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Splitting-wikipedia-summary-paragraphs-into-sentences">Splitting wikipedia summary paragraphs into sentences<a class="anchor-link" href="#Splitting-wikipedia-summary-paragraphs-into-sentences"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Currently our training data exists in in the form of a paragraphs. We will <strong>split the summary paragraphs into individual sentences</strong> before labeling them.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="k">def</span> <span class="nf">split_summaries</span><span class="p">(</span><span class="n">summaries</span><span class="p">,</span> <span class="n">country_As</span><span class="p">,</span> <span class="n">country_Bs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Split wikipedia summaries of each country pair into individual sentences</span>
<span class="sd">    </span>
<span class="sd">    args:</span>
<span class="sd">    ------</span>
<span class="sd">        summaries: (list) wikipedia summaries</span>
<span class="sd">        country_As: (list) countries in Country_A column</span>
<span class="sd">        country_Bs: (list) countries in Country_B column</span>
<span class="sd">    Return:</span>
<span class="sd">    ------</span>
<span class="sd">        sent_df: (pd.DataFrame) a new dataframe with each row representing</span>
<span class="sd">                  one sentence of a wikipedia summary</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">nlp</span> <span class="o">=</span> <span class="n">English</span><span class="p">()</span>
    <span class="n">nlp</span><span class="o">.</span><span class="n">add_pipe</span><span class="p">(</span><span class="n">nlp</span><span class="o">.</span><span class="n">create_pipe</span><span class="p">(</span><span class="s1">&#39;sentencizer&#39;</span><span class="p">))</span>

    <span class="n">sents</span> <span class="o">=</span> <span class="p">[</span><span class="n">sent</span><span class="o">.</span><span class="n">text</span> <span class="k">for</span> <span class="n">summary</span> <span class="ow">in</span> <span class="n">summaries</span> <span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="n">nlp</span><span class="p">(</span><span class="n">summary</span><span class="p">)</span><span class="o">.</span><span class="n">sents</span><span class="p">]</span>
    <span class="n">sents</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sents</span><span class="p">]</span>
    <span class="n">sents</span>

    <span class="c1"># We will have to replicate the names of the country as many times</span>
    <span class="c1"># as the number of sentences</span>
    <span class="n">sents_counts</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">nlp</span><span class="p">(</span><span class="n">summary</span><span class="p">)</span><span class="o">.</span><span class="n">sents</span><span class="p">))</span> <span class="k">for</span> <span class="n">summary</span> <span class="ow">in</span> <span class="n">summaries</span><span class="p">]</span>

    <span class="n">country_A_freq</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">country_As</span><span class="p">,</span> <span class="n">sents_counts</span><span class="p">))</span>
    <span class="n">country_B_freq</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">country_Bs</span><span class="p">,</span> <span class="n">sents_counts</span><span class="p">))</span>
    
    <span class="n">country_A_rep</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">country_A_freq</span><span class="p">))</span>
    <span class="n">country_B_rep</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">country_B_freq</span><span class="p">))</span>

    <span class="c1"># Create dataframe of sentences</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Summary_Sentence&#39;</span><span class="p">:</span><span class="n">sents</span><span class="p">,</span> <span class="s1">&#39;Country_A&#39;</span><span class="p">:</span> <span class="n">country_A_rep</span><span class="p">,</span> \
         <span class="s1">&#39;Country_B&#39;</span><span class="p">:</span> <span class="n">country_B_rep</span><span class="p">}</span>

    <span class="n">sent_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">sent_df</span><span class="p">[</span><span class="s1">&#39;Country_Pair&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sent_df</span><span class="p">[</span><span class="s1">&#39;Country_A&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">sent_df</span><span class="p">[</span><span class="s1">&#39;Country_B&#39;</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">sent_df</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">sent_l_df</span> <span class="o">=</span> <span class="n">split_summaries</span><span class="p">(</span><span class="n">wiki_l_df</span><span class="p">[</span><span class="s1">&#39;Summary&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                            <span class="n">wiki_l_df</span><span class="p">[</span><span class="s1">&#39;Country_A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                            <span class="n">wiki_l_df</span><span class="p">[</span><span class="s1">&#39;Country_B&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

<span class="n">sent_ul_df</span> <span class="o">=</span> <span class="n">split_summaries</span><span class="p">(</span><span class="n">wiki_ul_df</span><span class="p">[</span><span class="s1">&#39;Summary&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                             <span class="n">wiki_ul_df</span><span class="p">[</span><span class="s1">&#39;Country_A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                             <span class="n">wiki_ul_df</span><span class="p">[</span><span class="s1">&#39;Country_B&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">sent_l_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Summary_Sentence</th>
      <th>Country_A</th>
      <th>Country_B</th>
      <th>Country_Pair</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>China–Indonesia relations refer to the foreign...</td>
      <td>China</td>
      <td>Indonesia</td>
      <td>China_Indonesia</td>
    </tr>
    <tr>
      <th>1</th>
      <td>The relations between two nations have been on...</td>
      <td>China</td>
      <td>Indonesia</td>
      <td>China_Indonesia</td>
    </tr>
    <tr>
      <th>2</th>
      <td>However, the diplomatic relationship between t...</td>
      <td>China</td>
      <td>Indonesia</td>
      <td>China_Indonesia</td>
    </tr>
    <tr>
      <th>3</th>
      <td>China has an embassy in Jakarta and consulates...</td>
      <td>China</td>
      <td>Indonesia</td>
      <td>China_Indonesia</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Both countries are among the largest nations i...</td>
      <td>China</td>
      <td>Indonesia</td>
      <td>China_Indonesia</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Both nations are the members of APEC and G-20 ...</td>
      <td>China</td>
      <td>Indonesia</td>
      <td>China_Indonesia</td>
    </tr>
    <tr>
      <th>6</th>
      <td>According to a 2014 BBC World Service Poll, th...</td>
      <td>China</td>
      <td>Indonesia</td>
      <td>China_Indonesia</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Djibouti – United States relations are bilater...</td>
      <td>Djibouti</td>
      <td>United States</td>
      <td>Djibouti_United States</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Poland–Russia relations (Polish: Stosunki pols...</td>
      <td>Poland</td>
      <td>Russia</td>
      <td>Poland_Russia</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Over centuries, there have been several Polish...</td>
      <td>Poland</td>
      <td>Russia</td>
      <td>Poland_Russia</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Some-data-cleaning-to-do---Removing-irrelevant-sentences">Some data cleaning to do - Removing irrelevant sentences<a class="anchor-link" href="#Some-data-cleaning-to-do---Removing-irrelevant-sentences"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are some sentences that do not offer any insights into the relationships between countries. For example:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>United States – Singapore relations are bilateral relations between the United States and Singapore.</em></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It will be good for us to remove them to increase the performance of our model. Unfortunately, <strong>these sentences come in various forms</strong>. Let's take a look at another example:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>The Bahamas–United States relations refers to foreign relations between the Bahamas and States</em></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are more examples below if you are interested to look at them. We will use <strong>regex</strong> to remove them.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">regex_1</span> <span class="o">=</span> <span class="s1">&#39;^(The|&#39;&#39;)\s?[a-zA-Z\s]+(–|-|and)[a-zA-Z\s]+ relations refer[s]?&#39;</span>

<span class="n">regex_1_df</span> <span class="o">=</span> <span class="n">sent_ul_df</span><span class="p">[</span><span class="n">sent_ul_df</span><span class="p">[</span><span class="s1">&#39;Summary_Sentence&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">regex_1</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
<span class="n">regex_1_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)[</span><span class="s1">&#39;Summary_Sentence&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.6/dist-packages/pandas/core/strings.py:1843: UserWarning: This pattern has match groups. To actually get the groups, use str.extract.
  return func(self, *args, **kwargs)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;French–American relations refers to the diplomatic, social, economic and cultural relations between France and the United States since 1776.&#39;,
 &#39;Trinidad and Tobago–Venezuela relations refers to the bilateral relations between the Republic of Trinidad and Tobago and the Bolivarian Republic of Venezuela.&#39;,
 &#39;Bangladesh–Ukraine relations refer to the bilateral relations between Bangladesh and Ukraine.&#39;,
 &#39;Mauritius–Russia relations refers to the bilateral relations of Russia and Mauritius.&#39;,
 &#39;Bangladesh–Brunei relations refer to the bilateral relations between Bangladesh and Brunei.&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">regex_2</span> <span class="o">=</span> <span class="s1">&#39;^(The|&#39;&#39;)\s?[a-zA-Z\s]+(–|-|and)[a-zA-Z\s]+ relations (are|is)&#39;</span>

<span class="n">regex_2_df</span> <span class="o">=</span> <span class="n">sent_ul_df</span><span class="p">[</span><span class="n">sent_ul_df</span><span class="p">[</span><span class="s1">&#39;Summary_Sentence&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">regex_2</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
<span class="n">regex_2_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)[</span><span class="s1">&#39;Summary_Sentence&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.6/dist-packages/pandas/core/strings.py:1843: UserWarning: This pattern has match groups. To actually get the groups, use str.extract.
  return func(self, *args, **kwargs)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;British–Canadian relations are the relations between  Canada and the United Kingdom of Great Britain and Northern Ireland, being bilateral relations between their governments and wider relations between the 2 societies.&#39;,
 &#39;Bahrain–United Kingdom relations are bilateral relations between Kingdom of Bahrain and the United Kingdom of Great Britain and Northern Ireland.&#39;,
 &#39;Portugal–Russia relations are foreign relations between Portugal and Russia.&#39;,
 &#39;Cuba–Mexico relations are the diplomatic and bilateral relations between the Republic of Cuba and the United Mexican States.&#39;,
 &#39;Kyrgyzstan–Russia relations is the relationship between the two countries, Kyrgyzstan and Russia.&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>remove_invalid_sents</code> will help us to remove the different combinations that we have spotted so far.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="k">def</span> <span class="nf">remove_invalid_sents</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>

    <span class="c1"># Remove empty sentences</span>
    <span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Summary_Sentence&quot;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Remove sentences with ...relations refers to...</span>
    <span class="n">regex_1</span> <span class="o">=</span> <span class="s1">&#39;^(The|&#39;&#39;)\s?[a-zA-Z\s]+(–|-|and)[a-zA-Z\s]+ relations refer[s]?&#39;</span>
    <span class="n">regex_2</span> <span class="o">=</span> <span class="s1">&#39;^(The|&#39;&#39;)\s?[a-zA-Z\s]+(–|-|and)[a-zA-Z\s]+ relations (are|is)&#39;</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Summary_Sentence&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">regex_1</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Summary_Sentence&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">regex_2</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
    
    <span class="k">return</span> <span class="n">df</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">sent_l_df</span> <span class="o">=</span> <span class="n">remove_invalid_sents</span><span class="p">(</span><span class="n">sent_l_df</span><span class="p">)</span>
<span class="n">sent_ul_df</span> <span class="o">=</span> <span class="n">remove_invalid_sents</span><span class="p">(</span><span class="n">sent_ul_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.6/dist-packages/pandas/core/strings.py:1843: UserWarning: This pattern has match groups. To actually get the groups, use str.extract.
  return func(self, *args, **kwargs)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For now, we will exclude the summaries between <strong>"History of Japan"</strong> and "Korea" and instead analyze the relationship between <strong>"Japan"</strong> and "Korea".</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">hoj</span> <span class="o">=</span> <span class="n">sent_l_df</span><span class="p">[</span><span class="n">sent_l_df</span><span class="p">[</span><span class="s1">&#39;Country_A&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;History of Japan&#39;</span><span class="p">]</span>
<span class="n">hoj</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Summary_Sentence</th>
      <th>Country_A</th>
      <th>Country_B</th>
      <th>Country_Pair</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>14</th>
      <td>For over 15 centuries, the relationship betwee...</td>
      <td>History of Japan</td>
      <td>Korea</td>
      <td>History of Japan_Korea</td>
    </tr>
    <tr>
      <th>15</th>
      <td>During the ancient era, exchanges of cultures ...</td>
      <td>History of Japan</td>
      <td>Korea</td>
      <td>History of Japan_Korea</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Buddhism, Chinese-influenced cuisine, Han char...</td>
      <td>History of Japan</td>
      <td>Korea</td>
      <td>History of Japan_Korea</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Since 1945, relations involve three states: No...</td>
      <td>History of Japan</td>
      <td>Korea</td>
      <td>History of Japan_Korea</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Japan cut off Korea from Qing Chinese suzerain...</td>
      <td>History of Japan</td>
      <td>Korea</td>
      <td>History of Japan_Korea</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's save the data we have created into csv files.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">sent_l_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;./data/Wiki/sent_l.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">sent_ul_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;./data/Wiki/sent_ul.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I have manually labeled close to <strong>700 sentences</strong>, giving them a label of <strong>0, 1 and 2</strong> for negative, positive and neutral sentiments respectively. Let's read the file to obtain the labels <code>ld</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">sent_ld_all_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./data/Wiki/sent_ld.csv&#39;</span><span class="p">)</span>

<span class="n">sent_ld_all_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Summary_Sentence</th>
      <th>Label</th>
      <th>Country_A</th>
      <th>Country_B</th>
      <th>Country_Pair</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>The relations between two nations have been on...</td>
      <td>1</td>
      <td>China</td>
      <td>Indonesia</td>
      <td>China_Indonesia</td>
    </tr>
    <tr>
      <th>1</th>
      <td>However, the diplomatic relationship between t...</td>
      <td>0</td>
      <td>China</td>
      <td>Indonesia</td>
      <td>China_Indonesia</td>
    </tr>
    <tr>
      <th>2</th>
      <td>China has an embassy in Jakarta and consulates...</td>
      <td>1</td>
      <td>China</td>
      <td>Indonesia</td>
      <td>China_Indonesia</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Both countries are among the largest nations i...</td>
      <td>2</td>
      <td>China</td>
      <td>Indonesia</td>
      <td>China_Indonesia</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Both nations are the members of APEC and G-20 ...</td>
      <td>1</td>
      <td>China</td>
      <td>Indonesia</td>
      <td>China_Indonesia</td>
    </tr>
    <tr>
      <th>5</th>
      <td>\nAccording to a 2014 BBC World Service Poll, ...</td>
      <td>1</td>
      <td>China</td>
      <td>Indonesia</td>
      <td>China_Indonesia</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Poland–Russia relations (Polish: Stosunki pols...</td>
      <td>0</td>
      <td>Poland</td>
      <td>Russia</td>
      <td>Poland_Russia</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Over centuries, there have been several Polish...</td>
      <td>0</td>
      <td>Poland</td>
      <td>Russia</td>
      <td>Poland_Russia</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Polish–Russian relations entered a new phase f...</td>
      <td>2</td>
      <td>Poland</td>
      <td>Russia</td>
      <td>Poland_Russia</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Since then Polish–Russian relations have at ti...</td>
      <td>2</td>
      <td>Poland</td>
      <td>Russia</td>
      <td>Poland_Russia</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's step ahead a little. While working on this blog post, I did realise that the inclusion of sentences with <strong>neutral sentiments</strong> affects the performance of the model <strong>negatively</strong>. Below are some examples of these sentences. For now, let's <strong>exclude them</strong> and only train our model with sentences of positive and negative sentiments.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">sent_ld_neutral_df</span> <span class="o">=</span> <span class="n">sent_ld_all_df</span><span class="p">[</span><span class="n">sent_ld_all_df</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">sent_ld_neutral_df</span><span class="p">[</span><span class="s1">&#39;Summary_Sentence&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;Both countries are among the largest nations in Asia in terms of both area and population, China is the most populous nation on earth, while Indonesia has the 4th largest population in the world.&#39;,
 &#39;Polish–Russian relations entered a new phase following the fall of communism, 1989–1993.&#39;,
 &#39;Since then Polish–Russian relations have at times seen both improvement and deterioration.&#39;,
 &#39;The relationship was generally warm under the Russian President Boris Yeltsin (1991–99) until the NATO bombing of the Federal Republic of Yugoslavia in the spring of 1999, and has since deteriorated significantly.&#39;,
 &#39;Relations between the neighboring countries of Iran and the United Arab Emirates (UAE) are deeply historic, dating back centuries prior to the establishment of the modern-day United Arab Emirates; however today it has been described as up-and-down.&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">sent_ld_df</span> <span class="o">=</span> <span class="n">sent_ld_all_df</span><span class="p">[</span><span class="n">sent_ld_all_df</span><span class="p">[</span><span class="s1">&#39;Label&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Generating-training-and-development-datasets">Generating training and development datasets<a class="anchor-link" href="#Generating-training-and-development-datasets"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/fastpages/images/copied_from_nb/my_icons/geopolitical_mapper/tune_hyperparameters.JPG" alt="" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To tune our hyperparameters and prevent over/underfitting, we will need to generate a development (validation) dataset.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>While splitting the data, there is a need for us to <strong>split by country pairs to prevent any leakage in information</strong> about the countries' relations leaking from the training to development set.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">country_pairs</span> <span class="o">=</span> <span class="n">sent_ld_df</span><span class="p">[</span><span class="s1">&#39;Country_Pair&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">country_pairs_to_num</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">country_pairs</span><span class="p">)}</span>

<span class="n">sent_ld_df</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sent_ld_df</span><span class="p">[</span><span class="s1">&#39;Country_Pair&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">country_pairs_to_num</span><span class="p">)</span>

<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sent_ld_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="n">groupings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sent_ld_df</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

<span class="n">gss</span> <span class="o">=</span> <span class="n">GroupShuffleSplit</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="k">for</span> <span class="n">idx_1</span><span class="p">,</span> <span class="n">idx_2</span> <span class="ow">in</span> <span class="n">gss</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">groupings</span><span class="p">):</span>
  <span class="n">train_idx</span> <span class="o">=</span> <span class="n">idx_1</span>
  <span class="n">dev_idx</span> <span class="o">=</span> <span class="n">idx_2</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's save the training and development datasets into tsv files.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">train_data_df</span> <span class="o">=</span> <span class="n">sent_ld_df</span><span class="p">[[</span><span class="s1">&#39;Summary_Sentence&#39;</span><span class="p">,</span> <span class="s1">&#39;Label&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">train_idx</span><span class="p">]</span>
<span class="n">dev_data_df</span> <span class="o">=</span> <span class="n">sent_ld_df</span><span class="p">[[</span><span class="s1">&#39;Summary_Sentence&#39;</span><span class="p">,</span> <span class="s1">&#39;Label&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dev_idx</span><span class="p">]</span>

<span class="n">train_data_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;./data/Wiki/train.tsv&#39;</span><span class="p">,</span> <span class="n">float_format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%.0f</span><span class="s1">&#39;</span><span class="p">,</span> \
                     <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">dev_data_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;./data/Wiki/dev.tsv&#39;</span><span class="p">,</span> <span class="n">float_format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%.0f</span><span class="s1">&#39;</span><span class="p">,</span> \
                   <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Finetuning-ALBERT...-Finally!">Finetuning ALBERT... Finally!<a class="anchor-link" href="#Finetuning-ALBERT...-Finally!"> </a></h1><p>It is true when people say that in the field of Data Science, you spend most of the time analyzing and cleaning the data. We probably spent half of the blog post preparing the data for this section.</p>
<p>Now it is time for the exciting bit! <strong>We will create an <code>Albert</code> class that we will use to generate our sentiments.</strong> There are a couple of <strong>helper functions</strong> that <code>Albert</code> will be using. Most of the helper functions are adapted from the <a href="https://github.com/huggingface/transformers">Huggingface github page</a>. If there any tips on how I can do this better, do drop me an email!</p>
<p>The helper functions <code>_create_examples</code>, <code>_convert_examples_to_features</code>, <code>_read_tsv</code>, <code>create_dataset</code> are primarily used to <strong>convert our training and development datasets into a format</strong> that can be ingested by the Huggingface's model. Do check out this <a href="https://github.com/huggingface/transformers/blob/master/src/transformers/data/processors/utils.py">Huggingface github page</a> if you are interested in understanding the InputExample and InputFeatures data types.</p>
<p><code>_plot_cost_history</code> will be used to <strong>plot the training and development loss/accuracies</strong> to see how how our model is performing.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="k">def</span> <span class="nf">_create_examples</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">set_type</span><span class="p">,</span> <span class="n">col_num_text</span><span class="p">,</span> <span class="n">col_num_label</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper function for Albert&#39;s preprocess_str method.</span>
<span class="sd">    Create examples for the training and dev sets</span>

<span class="sd">    args:</span>
<span class="sd">    ------</span>
<span class="sd">        lines: (list) contains the guid, text to be labeled, and the label </span>
<span class="sd">        set_type: (str) denotes whether the lines are training or dev data</span>
<span class="sd">                  eg. &quot;train&quot;, &quot;dev&quot;</span>
<span class="sd">    Return:</span>
<span class="sd">    ------</span>
<span class="sd">        examples: (list) contains training/dev examples (InputExample object)</span>
<span class="sd">                        for sequence classification</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">examples</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
          <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">guid</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">-</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">set_type</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
          <span class="n">text_a</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">col_num_text</span><span class="p">]</span> <span class="c1"># To check if this is index 0</span>
          <span class="n">label</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">col_num_label</span><span class="p">]</span>
          <span class="n">examples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">InputExample</span><span class="p">(</span><span class="n">guid</span><span class="o">=</span><span class="n">guid</span><span class="p">,</span> <span class="n">text_a</span><span class="o">=</span><span class="n">text_a</span><span class="p">,</span> \
                                             <span class="n">text_b</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">))</span>
        
    <span class="k">return</span> <span class="n">examples</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="k">def</span> <span class="nf">_convert_examples_to_features</span><span class="p">(</span><span class="n">examples</span><span class="p">,</span> <span class="n">tokenizer</span><span class="p">,</span> <span class="n">max_length</span><span class="p">,</span> <span class="n">task</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper function for Albert&#39;s preprocess_str method.</span>
<span class="sd">    Convert data from examples to features</span>

<span class="sd">    args:</span>
<span class="sd">    ------</span>
<span class="sd">        examples: (list) contains training/dev examples ``InputExample``</span>
<span class="sd">                  for sequence classification</span>
<span class="sd">    Return:</span>
<span class="sd">    ------</span>
<span class="sd">        features: (list) contains task-specific ``InputFeatures``</span>
<span class="sd">                  which can be fed to the Albert model.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">label_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">]</span>
    <span class="n">features</span> <span class="o">=</span> <span class="n">glue_convert_examples_to_features</span><span class="p">(</span><span class="n">examples</span><span class="o">=</span><span class="n">examples</span><span class="p">,</span> \
                                                <span class="n">label_list</span><span class="o">=</span><span class="n">label_list</span><span class="p">,</span> \
                                                <span class="n">tokenizer</span><span class="o">=</span><span class="n">tokenizer</span><span class="p">,</span> \
                                                <span class="n">max_length</span><span class="o">=</span><span class="n">max_length</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="n">task</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">features</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="k">def</span> <span class="nf">_read_tsv</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper function for Albert&#39;s preprocess_str method.</span>
<span class="sd">    Reads a tab separated value file.</span>

<span class="sd">    args:</span>
<span class="sd">    ------</span>
<span class="sd">        file_path: (str) path leading to the tab separated tsv file</span>
<span class="sd">    Return:</span>
<span class="sd">    ------</span>
<span class="sd">        list with each element representing a row in the tsv file</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8-sig&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="k">def</span> <span class="nf">_create_dataset</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">buffer_size</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper function for Albert&#39;s preprocess_str method.</span>
<span class="sd">    Convert features into ``tf.data.Dataset``.</span>

<span class="sd">    args:</span>
<span class="sd">    ------</span>
<span class="sd">        features: (list) contains task-specific ``InputFeatures`` which can be</span>
<span class="sd">                  fed to the model.</span>
<span class="sd">        buffer_size: (int) representing the number of elements from this dataset</span>
<span class="sd">                    which the new dataset will sample from</span>
<span class="sd">        batch_size: (int) size of each batch generated from the dataset</span>
<span class="sd">    Return:</span>
<span class="sd">    ------</span>
<span class="sd">        A ``tf.data.Dataset`` containining task specific features</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">data_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">gen</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">ex</span> <span class="ow">in</span> <span class="n">features</span><span class="p">:</span>
            <span class="k">yield</span> <span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;input_ids&quot;</span><span class="p">:</span> <span class="n">ex</span><span class="o">.</span><span class="n">input_ids</span><span class="p">,</span>
                    <span class="s2">&quot;attention_mask&quot;</span><span class="p">:</span> <span class="n">ex</span><span class="o">.</span><span class="n">attention_mask</span><span class="p">,</span>
                    <span class="s2">&quot;token_type_ids&quot;</span><span class="p">:</span> <span class="n">ex</span><span class="o">.</span><span class="n">token_type_ids</span><span class="p">,</span>
                <span class="p">},</span>
                <span class="n">ex</span><span class="o">.</span><span class="n">label</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="n">train_dataset</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">from_generator</span><span class="p">(</span>
        <span class="n">gen</span><span class="p">,</span>
        <span class="p">({</span><span class="s2">&quot;input_ids&quot;</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="s2">&quot;attention_mask&quot;</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="s2">&quot;token_type_ids&quot;</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">int32</span><span class="p">},</span> <span class="n">tf</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>
        <span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;input_ids&quot;</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">([</span><span class="kc">None</span><span class="p">]),</span>
                <span class="s2">&quot;attention_mask&quot;</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">([</span><span class="kc">None</span><span class="p">]),</span>
                <span class="s2">&quot;token_type_ids&quot;</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">([</span><span class="kc">None</span><span class="p">]),</span>
            <span class="p">},</span>
            <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">([]),</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">train_dataset</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">buffer_size</span><span class="p">)</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="k">def</span> <span class="nf">_plot_cost_history</span><span class="p">(</span><span class="n">history</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper function for Albert&#39;s fintune method.</span>
<span class="sd">    Plots a line graph illustrating the loss for each epoch.</span>

<span class="sd">    args:</span>
<span class="sd">    ------</span>
<span class="sd">        history: (tf history object) contains the loss parameters to be charted</span>
<span class="sd">        epochs: (int) number of epochs. Used as the x-axis of the graph</span>
<span class="sd">    Return:</span>
<span class="sd">    ------</span>
<span class="sd">        A ``tf.data.Dataset`` containining task specific features</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Get number of epochs</span>
    <span class="n">n_epochs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>

    <span class="c1"># Top plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Accuracy/Loss&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_accuracy&#39;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Accuracy&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_epochs</span><span class="p">))</span>

    <span class="c1"># Bottom plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_loss&#39;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Loss&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

    <span class="c1"># Get number of epochs</span>
    <span class="n">n_epochs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_epochs</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;val&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;train_val.png&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="k">class</span> <span class="nc">Albert</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
          <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="n">albert4Seq</span> <span class="o">=</span> <span class="n">TFAlbertForSequenceClassification</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">albert_config</span><span class="p">,</span> <span class="n">output_attentions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">optimizer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lr</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">SparseCategoricalCrossentropy</span><span class="p">(</span><span class="n">from_logits</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">metric</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">SparseCategoricalAccuracy</span><span class="p">(</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)</span>

        <span class="n">albert4Seq</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">metric</span><span class="p">])</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_weights_path</span><span class="p">:</span>
          <span class="n">albert4Seq</span><span class="o">.</span><span class="n">load_weights</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">load_weights_path</span><span class="p">)</span>
          <span class="n">albert4Seq</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">lr</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lr</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">embed</span> <span class="o">=</span> <span class="n">albert4Seq</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer</span> <span class="o">=</span> <span class="n">AlbertTokenizer</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">albert_config</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;model initiated!&#39;</span><span class="p">)</span> 

    <span class="k">def</span> <span class="nf">preprocess_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">train_data_path</span><span class="p">,</span> <span class="n">dev_data_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads and converts training and dev data from a .tsv file into a</span>
<span class="sd">        tensorflow dataset</span>

<span class="sd">        args:</span>
<span class="sd">        ------</span>
<span class="sd">            train_data_path: (str) path leading to the training .tsv file</span>
<span class="sd">            dev_data_path: (int) path leading to the dev .tsv file</span>
<span class="sd">        Return:</span>
<span class="sd">        ------</span>
<span class="sd">            train_dataset: (tf.data.Dataset) containining task specific training</span>
<span class="sd">                          features</span>
<span class="sd">            dev_dataset: (tf.data.Dataset) containining task specific dev features</span>
<span class="sd">            train_size: (int) number of training data</span>
<span class="sd">            dev_size: (int) number of dev data</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">train_raw</span> <span class="o">=</span> <span class="n">_read_tsv</span><span class="p">(</span><span class="n">train_data_path</span><span class="p">)</span>
        <span class="n">dev_raw</span> <span class="o">=</span> <span class="n">_read_tsv</span><span class="p">(</span><span class="n">dev_data_path</span><span class="p">)</span>

        <span class="n">train_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_raw</span><span class="p">)</span>
        <span class="n">dev_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dev_raw</span><span class="p">)</span>

        <span class="n">train_examples</span> <span class="o">=</span> <span class="n">_create_examples</span><span class="p">(</span><span class="n">train_raw</span><span class="p">,</span>
                                          <span class="s2">&quot;train&quot;</span><span class="p">,</span>
                                          <span class="bp">self</span><span class="o">.</span><span class="n">col_num_text_a</span><span class="p">,</span>
                                          <span class="bp">self</span><span class="o">.</span><span class="n">col_num_label</span><span class="p">)</span>
        
        <span class="n">dev_examples</span> <span class="o">=</span> <span class="n">_create_examples</span><span class="p">(</span><span class="n">dev_raw</span><span class="p">,</span>
                                        <span class="s2">&quot;dev&quot;</span><span class="p">,</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">col_num_text_a</span><span class="p">,</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">col_num_label</span><span class="p">)</span>
        
        <span class="n">train_features</span> <span class="o">=</span> <span class="n">_convert_examples_to_features</span><span class="p">(</span><span class="n">train_examples</span><span class="p">,</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer</span><span class="p">,</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">max_seq_length</span><span class="p">,</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">task</span><span class="p">)</span>
        
        <span class="n">dev_features</span> <span class="o">=</span> <span class="n">_convert_examples_to_features</span><span class="p">(</span><span class="n">dev_examples</span><span class="p">,</span>
                                                      <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer</span><span class="p">,</span>
                                                      <span class="bp">self</span><span class="o">.</span><span class="n">max_seq_length</span><span class="p">,</span>
                                                      <span class="bp">self</span><span class="o">.</span><span class="n">task</span><span class="p">)</span>
        
        <span class="n">train_dataset</span> <span class="o">=</span> <span class="n">_create_dataset</span><span class="p">(</span><span class="n">train_features</span><span class="p">,</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">buffer_size</span><span class="p">,</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">)</span>
        
        <span class="n">dev_dataset</span> <span class="o">=</span> <span class="n">_create_dataset</span><span class="p">(</span><span class="n">dev_features</span><span class="p">,</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">buffer_size</span><span class="p">,</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">train_dataset</span><span class="p">,</span> <span class="n">dev_dataset</span><span class="p">,</span> <span class="n">train_size</span><span class="p">,</span> <span class="n">dev_size</span>

    <span class="k">def</span> <span class="nf">finetune</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Finetunes the Albert model</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">train_dataset</span><span class="p">,</span> <span class="n">dev_dataset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_size</span><span class="p">,</span> \
        <span class="bp">self</span><span class="o">.</span><span class="n">dev_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_str</span><span class="p">(</span><span class="n">train_data_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">train_data_path</span><span class="p">,</span>
                                            <span class="n">dev_data_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dev_data_path</span><span class="p">)</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dataset loaded!&#39;</span><span class="p">)</span>

        <span class="c1"># Callbacks</span>
        <span class="n">reduce_lr</span> <span class="o">=</span> <span class="n">ReduceLROnPlateau</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span>
                                      <span class="n">factor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reduce_lr_factor</span><span class="p">,</span>
                                      <span class="n">patience</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lr_patience</span><span class="p">,</span>
                                      <span class="n">min_lr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">min_lr</span><span class="p">)</span>

        <span class="n">checkpoint</span> <span class="o">=</span> <span class="n">ModelCheckpoint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkpoint_save_path</span><span class="p">,</span>
                                      <span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span>
                                      <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                      <span class="n">save_best_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                      <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">)</span>

        <span class="n">early_stop</span> <span class="o">=</span>  <span class="n">EarlyStopping</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span>
                                    <span class="n">patience</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">early_stop_patience</span><span class="p">,</span>
                                    <span class="n">restore_best_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Model</span>
        <span class="n">epochs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_epochs</span>
        <span class="n">train_steps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_size</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span>
        <span class="n">valid_steps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dev_size</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span>

        <span class="n">albert_history</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">embed</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">,</span> 
                                        <span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">,</span> 
                                        <span class="n">steps_per_epoch</span><span class="o">=</span><span class="n">train_steps</span><span class="p">,</span>
                                        <span class="n">validation_data</span><span class="o">=</span><span class="n">dev_dataset</span><span class="p">,</span>
                                        <span class="n">validation_steps</span><span class="o">=</span><span class="n">valid_steps</span><span class="p">,</span>
                                        <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">reduce_lr</span><span class="p">,</span>
                                                  <span class="n">checkpoint</span><span class="p">,</span>
                                                  <span class="n">early_stop</span><span class="p">])</span>

        <span class="c1"># Plot loss</span>
        <span class="n">_plot_cost_history</span><span class="p">(</span><span class="n">albert_history</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">export</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Export finetuned model</span>

<span class="sd">        args:</span>
<span class="sd">        ------</span>
<span class="sd">            file_path: (str) path leading to the directory to save the </span>
<span class="sd">                      finetuned model</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">embed</span><span class="o">.</span><span class="n">save_weights</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">restore</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Restore Albert model with finetuned model</span>

<span class="sd">        args:</span>
<span class="sd">        ------</span>
<span class="sd">            file_path: (str) path leading to the directory with finetuned model</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">embed</span><span class="o">.</span><span class="n">load_weights</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Finetuning-on-SQUAD-SST-2-Task">Finetuning on SQUAD SST-2 Task<a class="anchor-link" href="#Finetuning-on-SQUAD-SST-2-Task"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/fastpages/images/copied_from_nb/my_icons/geopolitical_mapper/transfer_learning.JPG" alt="" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Huggingface offers pretrained models that need to be finetuned for your own use case. At this point, the Huggingface ALBERT model is not capable of differentiating between positive and negative sentiments. For ALBERT to learn how to differentiate the two types of sentiment, we will need to first <strong>finetune <code>Albert</code> using SQUAD's SST-2 dataset</strong>. The SST-2 dataset contains sentences from <strong>movie reviews</strong> and human annotations of their sentiments. Here are two examples adapted from the dataset:</p>
<ul>
<li><p>Negative sentiment -  <em>contains no wit , only labored gags</em></p>
</li>
<li><p>Positive sentiment - <em>are more deeply thought through than in most right-thinking films</em></p>
</li>
</ul>
<p>Once we have trained a model capable of differentiating negative and sentiments by analyzing movie reviews, we will <strong>implement transfer learning to further finetune the model with our own Wikipedia summary dataset</strong>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To download the SST-2 dataset, we will use Huggingface's <code>download_and_extract</code>. You can use the same function to download other SQUAD related datasets that you would like to finetune on.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">TASKS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;CoLA&quot;</span><span class="p">,</span> <span class="s2">&quot;SST&quot;</span><span class="p">,</span> <span class="s2">&quot;MRPC&quot;</span><span class="p">,</span> <span class="s2">&quot;QQP&quot;</span><span class="p">,</span> <span class="s2">&quot;STS&quot;</span><span class="p">,</span> <span class="s2">&quot;MNLI&quot;</span><span class="p">,</span> <span class="s2">&quot;SNLI&quot;</span><span class="p">,</span> <span class="s2">&quot;QNLI&quot;</span><span class="p">,</span> <span class="s2">&quot;RTE&quot;</span><span class="p">,</span> <span class="s2">&quot;WNLI&quot;</span><span class="p">,</span> <span class="s2">&quot;diagnostic&quot;</span><span class="p">]</span>
<span class="n">TASK2PATH</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;CoLA&quot;</span><span class="p">:</span><span class="s1">&#39;https://firebasestorage.googleapis.com/v0/b/mtl-sentence-representations.appspot.com/o/data</span><span class="si">%2F</span><span class="s1">CoLA.zip?alt=media&amp;token=46d5e637-3411-4188-bc44-5809b5bfb5f4&#39;</span><span class="p">,</span>
             <span class="s2">&quot;SST&quot;</span><span class="p">:</span><span class="s1">&#39;https://firebasestorage.googleapis.com/v0/b/mtl-sentence-representations.appspot.com/o/data</span><span class="si">%2F</span><span class="s1">SST-2.zip?alt=media&amp;token=aabc5f6b-e466-44a2-b9b4-cf6337f84ac8&#39;</span><span class="p">,</span>
             <span class="s2">&quot;MRPC&quot;</span><span class="p">:</span><span class="s1">&#39;https://firebasestorage.googleapis.com/v0/b/mtl-sentence-representations.appspot.com/o/data</span><span class="si">%2F</span><span class="s1">mrpc_dev_ids.tsv?alt=media&amp;token=ec5c0836-31d5-48f4-b431-7480817f1adc&#39;</span><span class="p">,</span>
             <span class="s2">&quot;QQP&quot;</span><span class="p">:</span><span class="s1">&#39;https://firebasestorage.googleapis.com/v0/b/mtl-sentence-representations.appspot.com/o/data</span><span class="si">%2F</span><span class="s1">QQP.zip?alt=media&amp;token=700c6acf-160d-4d89-81d1-de4191d02cb5&#39;</span><span class="p">,</span>
             <span class="s2">&quot;STS&quot;</span><span class="p">:</span><span class="s1">&#39;https://firebasestorage.googleapis.com/v0/b/mtl-sentence-representations.appspot.com/o/data</span><span class="si">%2F</span><span class="s1">STS-B.zip?alt=media&amp;token=bddb94a7-8706-4e0d-a694-1109e12273b5&#39;</span><span class="p">,</span>
             <span class="s2">&quot;MNLI&quot;</span><span class="p">:</span><span class="s1">&#39;https://firebasestorage.googleapis.com/v0/b/mtl-sentence-representations.appspot.com/o/data</span><span class="si">%2F</span><span class="s1">MNLI.zip?alt=media&amp;token=50329ea1-e339-40e2-809c-10c40afff3ce&#39;</span><span class="p">,</span>
             <span class="s2">&quot;SNLI&quot;</span><span class="p">:</span><span class="s1">&#39;https://firebasestorage.googleapis.com/v0/b/mtl-sentence-representations.appspot.com/o/data</span><span class="si">%2F</span><span class="s1">SNLI.zip?alt=media&amp;token=4afcfbb2-ff0c-4b2d-a09a-dbf07926f4df&#39;</span><span class="p">,</span>
             <span class="s2">&quot;QNLI&quot;</span><span class="p">:</span> <span class="s1">&#39;https://firebasestorage.googleapis.com/v0/b/mtl-sentence-representations.appspot.com/o/data</span><span class="si">%2F</span><span class="s1">QNLIv2.zip?alt=media&amp;token=6fdcf570-0fc5-4631-8456-9505272d1601&#39;</span><span class="p">,</span>
             <span class="s2">&quot;RTE&quot;</span><span class="p">:</span><span class="s1">&#39;https://firebasestorage.googleapis.com/v0/b/mtl-sentence-representations.appspot.com/o/data</span><span class="si">%2F</span><span class="s1">RTE.zip?alt=media&amp;token=5efa7e85-a0bb-4f19-8ea2-9e1840f077fb&#39;</span><span class="p">,</span>
             <span class="s2">&quot;WNLI&quot;</span><span class="p">:</span><span class="s1">&#39;https://firebasestorage.googleapis.com/v0/b/mtl-sentence-representations.appspot.com/o/data</span><span class="si">%2F</span><span class="s1">WNLI.zip?alt=media&amp;token=068ad0a0-ded7-4bd7-99a5-5e00222e0faf&#39;</span><span class="p">,</span>
             <span class="s2">&quot;diagnostic&quot;</span><span class="p">:</span><span class="s1">&#39;https://storage.googleapis.com/mtl-sentence-representations.appspot.com/tsvsWithoutLabels</span><span class="si">%2F</span><span class="s1">AX.tsv?GoogleAccessId=firebase-adminsdk-0khhl@mtl-sentence-representations.iam.gserviceaccount.com&amp;Expires=2498860800&amp;Signature=DuQ2CSPt2Yfre0C%2BiISrVYrIFaZH1Lc7hBVZDD4ZyR7fZYOMNOUGpi8QxBmTNOrNPjR3z1cggo7WXFfrgECP6FBJSsURv8Ybrue8Ypt</span><span class="si">%2F</span><span class="s1">TPxbuJ0Xc2FhDi%2BarnecCBFO77RSbfuz%2Bs95hRrYhTnByqu3U</span><span class="si">%2F</span><span class="s1">YZPaj3tZt5QdfpH2IUROY8LiBXoXS46LE</span><span class="si">%2F</span><span class="s1">gOQc</span><span class="si">%2F</span><span class="s1">KN%2BA9SoscRDYsnxHfG0IjXGwHN%2Bf88q6hOmAxeNPx6moDulUF6XMUAaXCSFU%2BnRO2RDL9CapWxj%2BDl7syNyHhB7987hZ80B</span><span class="si">%2F</span><span class="s1">wFkQ3MEs8auvt5XW1%2Bd4aCU7ytgM69r8JDCwibfhZxpaa4gd50QXQ%3D%3D&#39;</span><span class="p">}</span>


<span class="k">def</span> <span class="nf">download_and_extract</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used to download SQUAD dataset for training.</span>
<span class="sd">    Credits to Huggingface</span>

<span class="sd">    args:</span>
<span class="sd">    ------</span>
<span class="sd">        task: (str) SQUAD task of interest</span>
<span class="sd">        file_path: (str) path to save the dataset in</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Downloading and extracting </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">task</span><span class="p">)</span>
    <span class="n">data_file</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.zip&quot;</span> <span class="o">%</span> <span class="n">task</span>
    <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">TASK2PATH</span><span class="p">[</span><span class="n">task</span><span class="p">],</span> <span class="n">data_file</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">data_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_ref</span><span class="p">:</span>
        <span class="n">zip_ref</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">data_file</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Completed!&quot;</span><span class="p">)</span>


  <span class="n">download_and_extract</span><span class="p">(</span><span class="s2">&quot;SST&quot;</span><span class="p">,</span> <span class="s1">&#39;./data/&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Downloading and extracting SST...
	Completed!
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <strong>data files and hyperparameters</strong> needed to finetune <code>Albert</code> on the <strong>SQUAD SST-2 task and our Wikipedia summaries are different</strong>. To easily facilitate the different training requirements, we will wrap the data paths and parameters in a <strong><code>config</code> dictionary</strong>. Which will be <strong>used to instantiate</strong> <code>Albert</code> before finetuning begins.</p>
<p>The config to finetune on SQUAD:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">config_squad</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;albert_config&quot;</span><span class="p">:</span> <span class="s2">&quot;albert-base-v2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;task&quot;</span><span class="p">:</span> <span class="s2">&quot;sst-2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;max_seq_length&quot;</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span>
    <span class="s2">&quot;buffer_size&quot;</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span>
    <span class="s2">&quot;batch_size&quot;</span><span class="p">:</span> <span class="mi">36</span><span class="p">,</span>
    <span class="s2">&quot;test_size&quot;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
    <span class="s2">&quot;random_state&quot;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
    <span class="s2">&quot;load_weights_path&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lr&quot;</span><span class="p">:</span> <span class="mf">5e-6</span><span class="p">,</span>
    <span class="s2">&quot;reduce_lr_factor&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="s2">&quot;lr_patience&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;early_stop_patience&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s2">&quot;num_epochs&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;min_lr&quot;</span><span class="p">:</span> <span class="mf">5e-9</span><span class="p">,</span>
    <span class="s2">&quot;train_data_path&quot;</span><span class="p">:</span> <span class="s2">&quot;./data/SST-2/train.tsv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dev_data_path&quot;</span><span class="p">:</span> <span class="s2">&quot;./data/SST-2/dev.tsv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;col_num_text_a&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;col_num_label&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;checkpoint_save_path&quot;</span><span class="p">:</span> <span class="s2">&quot;./model/squad-weights-improvement-</span><span class="si">{epoch:02d}</span><span class="s2">.ckpt&quot;</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The finetuning logs can be seen below. The <strong>fourth epoch</strong> seems to be our best run with the lowest <code>val_loss</code> (0.4706).</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">albert_squad</span> <span class="o">=</span> <span class="n">Albert</span><span class="p">(</span><span class="o">**</span><span class="n">config_squad</span><span class="p">)</span>

<span class="n">albert_squad</span><span class="o">.</span><span class="n">finetune</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>model initiated!
dataset loaded!
Train for 1870 steps, validate for 24 steps
Epoch 1/10
1869/1870 [============================&gt;.] - ETA: 0s - loss: 0.5781 - accuracy: 0.6841
Epoch 00001: val_loss improved from inf to 0.55461, saving model to ./model/squad-weights-improvement-01.ckpt
1870/1870 [==============================] - 1013s 542ms/step - loss: 0.5780 - accuracy: 0.6841 - val_loss: 0.5546 - val_accuracy: 0.7222
Epoch 2/10
1869/1870 [============================&gt;.] - ETA: 0s - loss: 0.4043 - accuracy: 0.8158
Epoch 00002: val_loss improved from 0.55461 to 0.52056, saving model to ./model/squad-weights-improvement-02.ckpt
1870/1870 [==============================] - 989s 529ms/step - loss: 0.4043 - accuracy: 0.8158 - val_loss: 0.5206 - val_accuracy: 0.7708
Epoch 3/10
1869/1870 [============================&gt;.] - ETA: 0s - loss: 0.3226 - accuracy: 0.8628
Epoch 00003: val_loss did not improve from 0.52056
1870/1870 [==============================] - 990s 530ms/step - loss: 0.3226 - accuracy: 0.8628 - val_loss: 0.5379 - val_accuracy: 0.7801
Epoch 4/10
1869/1870 [============================&gt;.] - ETA: 0s - loss: 0.2661 - accuracy: 0.8911
Epoch 00004: val_loss improved from 0.52056 to 0.47058, saving model to ./model/squad-weights-improvement-04.ckpt
1870/1870 [==============================] - 990s 529ms/step - loss: 0.2662 - accuracy: 0.8911 - val_loss: 0.4706 - val_accuracy: 0.8032
Epoch 5/10
1869/1870 [============================&gt;.] - ETA: 0s - loss: 0.2596 - accuracy: 0.8944
Epoch 00005: val_loss did not improve from 0.47058
1870/1870 [==============================] - 989s 529ms/step - loss: 0.2596 - accuracy: 0.8944 - val_loss: 0.4746 - val_accuracy: 0.8021
Epoch 6/10
1869/1870 [============================&gt;.] - ETA: 0s - loss: 0.2532 - accuracy: 0.8974
Epoch 00006: val_loss did not improve from 0.47058
1870/1870 [==============================] - 989s 529ms/step - loss: 0.2533 - accuracy: 0.8973 - val_loss: 0.4724 - val_accuracy: 0.8067
Epoch 7/10
1869/1870 [============================&gt;.] - ETA: 0s - loss: 0.2526 - accuracy: 0.8976
Epoch 00007: val_loss did not improve from 0.47058
1870/1870 [==============================] - 989s 529ms/step - loss: 0.2526 - accuracy: 0.8976 - val_loss: 0.4764 - val_accuracy: 0.8044
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Finetune-using-our-labeled-dataset">Finetune using our labeled dataset<a class="anchor-link" href="#Finetune-using-our-labeled-dataset"> </a></h2><p>Ok we have finetuned <code>Albert</code> to pick out the positive and negative sentiments movie reviews. Finally, we will finetune <code>Albert</code> for our use case using the following configurations. The <strong>eighth epoch</strong> gave the best run with the lowest loss (0.4546).</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">config_summaries</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;albert_config&quot;</span><span class="p">:</span> <span class="s2">&quot;albert-base-v2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;task&quot;</span><span class="p">:</span> <span class="s2">&quot;sst-2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;max_seq_length&quot;</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span>
    <span class="s2">&quot;buffer_size&quot;</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span>
    <span class="s2">&quot;batch_size&quot;</span><span class="p">:</span> <span class="mi">36</span><span class="p">,</span>
    <span class="s2">&quot;test_size&quot;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
    <span class="s2">&quot;random_state&quot;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
    <span class="s2">&quot;load_weights_path&quot;</span><span class="p">:</span> <span class="s2">&quot;./model/squad-weights-improvement-04.ckpt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lr&quot;</span><span class="p">:</span> <span class="mf">5e-5</span><span class="p">,</span>
    <span class="s2">&quot;reduce_lr_factor&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="s2">&quot;lr_patience&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;early_stop_patience&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="s2">&quot;num_epochs&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="s2">&quot;min_lr&quot;</span><span class="p">:</span> <span class="mf">5e-9</span><span class="p">,</span>
    <span class="s2">&quot;train_data_path&quot;</span><span class="p">:</span> <span class="s2">&quot;./data/Wiki/train.tsv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dev_data_path&quot;</span><span class="p">:</span> <span class="s2">&quot;./data/Wiki/dev.tsv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;col_num_text_a&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;col_num_label&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;checkpoint_save_path&quot;</span><span class="p">:</span> <span class="s2">&quot;./model/summary-weights-improvement-</span><span class="si">{epoch:02d}</span><span class="s2">.ckpt&quot;</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">albert_summaries</span> <span class="o">=</span> <span class="n">Albert</span><span class="p">(</span><span class="o">**</span><span class="n">config_summaries</span><span class="p">)</span>

<span class="n">albert_summaries</span><span class="o">.</span><span class="n">finetune</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>model initiated!
dataset loaded!
Train for 10 steps, validate for 3 steps
Epoch 1/20
 9/10 [==========================&gt;...] - ETA: 2s - loss: 0.6752 - accuracy: 0.7068
Epoch 00001: val_loss improved from inf to 0.70040, saving model to ./model/summary-weights-improvement-01.ckpt
10/10 [==============================] - 30s 3s/step - loss: 0.6479 - accuracy: 0.7306 - val_loss: 0.7004 - val_accuracy: 0.6204
Epoch 2/20
 9/10 [==========================&gt;...] - ETA: 0s - loss: 0.5817 - accuracy: 0.7081
Epoch 00002: val_loss improved from 0.70040 to 0.57846, saving model to ./model/summary-weights-improvement-02.ckpt
10/10 [==============================] - 7s 661ms/step - loss: 0.5813 - accuracy: 0.7095 - val_loss: 0.5785 - val_accuracy: 0.7778
Epoch 3/20
 9/10 [==========================&gt;...] - ETA: 0s - loss: 0.3281 - accuracy: 0.8975
Epoch 00003: val_loss did not improve from 0.57846
10/10 [==============================] - 6s 600ms/step - loss: 0.3277 - accuracy: 0.8883 - val_loss: 0.9524 - val_accuracy: 0.6574
Epoch 4/20
 9/10 [==========================&gt;...] - ETA: 0s - loss: 0.2239 - accuracy: 0.9317
Epoch 00004: val_loss did not improve from 0.57846
10/10 [==============================] - 6s 607ms/step - loss: 0.2173 - accuracy: 0.9330 - val_loss: 0.5976 - val_accuracy: 0.7593
Epoch 5/20
 9/10 [==========================&gt;...] - ETA: 0s - loss: 0.0883 - accuracy: 0.9720
Epoch 00005: val_loss improved from 0.57846 to 0.54417, saving model to ./model/summary-weights-improvement-05.ckpt
10/10 [==============================] - 7s 652ms/step - loss: 0.0857 - accuracy: 0.9749 - val_loss: 0.5442 - val_accuracy: 0.8056
Epoch 6/20
 9/10 [==========================&gt;...] - ETA: 0s - loss: 0.0800 - accuracy: 0.9752
Epoch 00006: val_loss improved from 0.54417 to 0.49869, saving model to ./model/summary-weights-improvement-06.ckpt
10/10 [==============================] - 7s 693ms/step - loss: 0.0787 - accuracy: 0.9749 - val_loss: 0.4987 - val_accuracy: 0.7963
Epoch 7/20
 9/10 [==========================&gt;...] - ETA: 0s - loss: 0.0740 - accuracy: 0.9814
Epoch 00007: val_loss did not improve from 0.49869
10/10 [==============================] - 6s 604ms/step - loss: 0.0701 - accuracy: 0.9832 - val_loss: 0.5500 - val_accuracy: 0.7593
Epoch 8/20
 9/10 [==========================&gt;...] - ETA: 0s - loss: 0.0639 - accuracy: 0.9783
Epoch 00008: val_loss improved from 0.49869 to 0.45457, saving model to ./model/summary-weights-improvement-08.ckpt
10/10 [==============================] - 7s 678ms/step - loss: 0.0592 - accuracy: 0.9804 - val_loss: 0.4546 - val_accuracy: 0.8148
Epoch 9/20
 9/10 [==========================&gt;...] - ETA: 0s - loss: 0.0410 - accuracy: 0.9876
Epoch 00009: val_loss did not improve from 0.45457
10/10 [==============================] - 6s 599ms/step - loss: 0.0380 - accuracy: 0.9888 - val_loss: 0.5704 - val_accuracy: 0.7778
Epoch 10/20
 9/10 [==========================&gt;...] - ETA: 0s - loss: 0.0323 - accuracy: 0.9876
Epoch 00010: val_loss did not improve from 0.45457
10/10 [==============================] - 6s 599ms/step - loss: 0.0301 - accuracy: 0.9888 - val_loss: 0.5205 - val_accuracy: 0.8056
Epoch 11/20
 9/10 [==========================&gt;...] - ETA: 0s - loss: 0.0259 - accuracy: 0.9907
Epoch 00011: val_loss did not improve from 0.45457
10/10 [==============================] - 6s 588ms/step - loss: 0.0248 - accuracy: 0.9916 - val_loss: 0.5801 - val_accuracy: 0.7778
Epoch 12/20
 9/10 [==========================&gt;...] - ETA: 0s - loss: 0.0183 - accuracy: 0.9969
Epoch 00012: val_loss did not improve from 0.45457
10/10 [==============================] - 6s 597ms/step - loss: 0.0235 - accuracy: 0.9917 - val_loss: 0.5456 - val_accuracy: 0.7870
Epoch 13/20
 9/10 [==========================&gt;...] - ETA: 0s - loss: 0.0170 - accuracy: 0.9969
Epoch 00013: val_loss did not improve from 0.45457
10/10 [==============================] - 6s 595ms/step - loss: 0.0181 - accuracy: 0.9972 - val_loss: 0.5932 - val_accuracy: 0.7778
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
cZym4/8BXYIiDlC7PicAAAAASUVORK5CYII=
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Predict-Sentiment">Predict Sentiment<a class="anchor-link" href="#Predict-Sentiment"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/fastpages/images/copied_from_nb/my_icons/geopolitical_mapper/crystal_ball.JPG" alt="" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With the model finetuned with our labeled dataset, we can use it to come up with sentiment predictions. <strong>The sentences need to be encoded</strong> before feeding it into the model to obtain the logits <code>logit = albert_summaries.embed(encoded_s)[0]</code>. We will then place the logits through a <strong>softmax function</strong> <code>_get_proba</code> to obtain the probabilities that the sentiments are negative or positive.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="k">def</span> <span class="nf">_get_proba</span><span class="p">(</span><span class="n">logit</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper function for get_predictions_probas</span>
<span class="sd">    Computes softmax values based on logit</span>

<span class="sd">    args:</span>
<span class="sd">    ------</span>
<span class="sd">        logit: (float) logit output of finetuned ALBERT model</span>
<span class="sd">    Return:</span>
<span class="sd">    ------</span>
<span class="sd">        softmax values representing the sentiment probabilities</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">logit</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">logit</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="k">def</span> <span class="nf">get_predictions_probas</span><span class="p">(</span><span class="n">summaries</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">weights_path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the sentiment probabilities (positive or negative sentiments)</span>
<span class="sd">    for the wiki summary sentences</span>

<span class="sd">    args:</span>
<span class="sd">    ------</span>
<span class="sd">        summaries: (list) wiki summary sentences that require sentiment predictions</span>
<span class="sd">        config: (dict) chosen configuration for the ALBERT model</span>
<span class="sd">        weights_path: (str) path leading to the weights of the finetuned</span>
<span class="sd">                      ALBERT model</span>
<span class="sd">    Return:</span>
<span class="sd">    ------</span>
<span class="sd">        sentiment_preds: (list) sentiment predictions for the wiki summary sentences</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">albert_summaries</span> <span class="o">=</span> <span class="n">Albert</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="p">)</span>
    <span class="n">albert_summaries</span><span class="o">.</span><span class="n">restore</span><span class="p">(</span><span class="n">weights_path</span><span class="p">)</span>

    <span class="n">sentiment_probas</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">summaries</span><span class="p">):</span>

      <span class="n">encoded_s</span> <span class="o">=</span> <span class="n">albert_summaries</span><span class="o">.</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">encode_plus</span><span class="p">(</span><span class="n">s</span><span class="p">,</span>
                                                        <span class="n">text_pair</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                                        <span class="n">max_length</span><span class="o">=</span><span class="n">albert_summaries</span><span class="o">.</span><span class="n">max_seq_length</span><span class="p">,</span>
                                                        <span class="n">pad_to_max_length</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                        <span class="n">add_special_tokens</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                        <span class="n">return_tensors</span><span class="o">=</span><span class="s2">&quot;tf&quot;</span><span class="p">)</span>
    
      <span class="n">logit</span> <span class="o">=</span> <span class="n">albert_summaries</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">encoded_s</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
      <span class="n">pred</span> <span class="o">=</span> <span class="n">_get_proba</span><span class="p">(</span><span class="n">logit</span><span class="p">)</span>
      <span class="n">sentiment_probas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pred</span><span class="p">[:,</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">sentiment_probas</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="o">%%capture</span>

<span class="n">sent_ld_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./data/Wiki/sent_ld.csv&#39;</span><span class="p">)</span>
<span class="n">sent_ul_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./data/Wiki/sent_ul.csv&#39;</span><span class="p">)</span>

<span class="n">sent_all_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">sent_ld_df</span><span class="p">,</span> <span class="n">sent_ul_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">summaries</span> <span class="o">=</span> <span class="n">sent_all_df</span><span class="p">[</span><span class="s1">&#39;Summary_Sentence&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">sentiment_probas</span> <span class="o">=</span> <span class="n">get_predictions_probas</span><span class="p">(</span><span class="n">summaries</span><span class="p">,</span> <span class="n">config_summaries</span><span class="p">,</span>
                                          <span class="s1">&#39;./model/summary-weights-improvement-08.ckpt&#39;</span><span class="p">)</span>

<span class="n">sent_all_df</span><span class="p">[</span><span class="s1">&#39;Predictions_Probas&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sentiment_probas</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And here we have the sentiment probabilities for the sentences! Sentences with probabilities that are <strong>closer to 1</strong> are considered to have <strong>positive sentiments</strong>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">sent_all_df</span><span class="p">[[</span><span class="s1">&#39;Country_Pair&#39;</span><span class="p">,</span> <span class="s1">&#39;Label&#39;</span><span class="p">,</span> <span class="s1">&#39;Summary_Sentence&#39;</span><span class="p">,</span> <span class="s1">&#39;Predictions_Probas&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country_Pair</th>
      <th>Label</th>
      <th>Summary_Sentence</th>
      <th>Predictions_Probas</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>China_Indonesia</td>
      <td>1.0</td>
      <td>The relations between two nations have been on...</td>
      <td>0.279244</td>
    </tr>
    <tr>
      <th>1</th>
      <td>China_Indonesia</td>
      <td>0.0</td>
      <td>However, the diplomatic relationship between t...</td>
      <td>0.052571</td>
    </tr>
    <tr>
      <th>2</th>
      <td>China_Indonesia</td>
      <td>1.0</td>
      <td>China has an embassy in Jakarta and consulates...</td>
      <td>0.990907</td>
    </tr>
    <tr>
      <th>3</th>
      <td>China_Indonesia</td>
      <td>2.0</td>
      <td>Both countries are among the largest nations i...</td>
      <td>0.990101</td>
    </tr>
    <tr>
      <th>4</th>
      <td>China_Indonesia</td>
      <td>1.0</td>
      <td>Both nations are the members of APEC and G-20 ...</td>
      <td>0.985640</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="How-did-we-do?-On-to-the-results!">How did we do? On to the results!<a class="anchor-link" href="#How-did-we-do?-On-to-the-results!"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/fastpages/images/copied_from_nb/my_icons/geopolitical_mapper/excited_baby.JPG" alt="" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To be honest, I do not know how the results will turn out at this point given that the dataset that we were using was self-generated and manually labeled. On a positive note, it appears that the model was able to predict some of the sentiments correctly.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Correctly-classified-relationships">Correctly classified relationships<a class="anchor-link" href="#Correctly-classified-relationships"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="c1"># Sentences</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sent_all_df</span><span class="p">[</span><span class="n">sent_all_df</span><span class="p">[</span><span class="s1">&#39;Country_Pair&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;China_Singapore&#39;</span><span class="p">][</span><span class="s1">&#39;Summary_Sentence&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

<span class="c1"># Sentiment probabilities</span>
<span class="n">sent_all_df</span><span class="p">[</span><span class="n">sent_all_df</span><span class="p">[</span><span class="s1">&#39;Country_Pair&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;China_Singapore&#39;</span><span class="p">][</span><span class="s1">&#39;Predictions_Probas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#34;People&#39;s Republic of China – Singapore relations officially started on 3 October 1990.&#34;, &#39;Diplomatic missions were established in the early 1990s based on trade and the warming of ties from other ASEAN countries towards mainland China.&#39;, &#39;Singapore and China have maintained a long-standing and greatly prioritised close relationship, and partly because of the latter\&#39;s growing influence and essentiality in the Asia-Pacific region, specifying that &#34;its common interest with China is far greater than any differences&#34;.&#39;, &#34;Furthermore, Singapore has positioned itself as a strong supporter for China&#39;s constructive engagement and peaceful development in the region.&#34;, &#34;It has engaged co-operation with other ASEAN members and China to strengthen regional security and fight terrorism, while participating in the organisation&#39;s first maritime exercise with the latter.&#34;, &#34;While relationship between the two countries stand strong, differences were experienced during numerous high-profile events, including Singapore&#39;s stance against China regarding the South China Sea dispute, Singapore&#39;s support for the United States&#39; military presence and alliance system in Asia and the seizing of SAF vehicles by Hong Kong authorities in November 2016.Despite the disputes, Singapore and Beijing have consistently affirm their unwavering close relationship and bilateral ties, deepening their co-operation in numerous areas, including defence, economy, culture and education, as well as One Belt One Road Initiative.&#34;, &#34;Singapore has also vowed to fully support and promote China&#39;s position in ASEAN, while managing the differences between the Chinese state and the organisation.&#34;]
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[0.9891862273216248,
 0.98930823802948,
 0.9773917198181152,
 0.990622878074646,
 0.9888237714767456,
 0.9899033308029175,
 0.9854150414466858]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="c1"># Sentences</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sent_all_df</span><span class="p">[</span><span class="n">sent_all_df</span><span class="p">[</span><span class="s1">&#39;Country_Pair&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Russia_United States&#39;</span><span class="p">][</span><span class="s1">&#39;Summary_Sentence&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span>

<span class="c1"># Sentiment probabilities</span>
<span class="n">sent_all_df</span><span class="p">[</span><span class="n">sent_all_df</span><span class="p">[</span><span class="s1">&#39;Country_Pair&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Russia_United States&#39;</span><span class="p">][</span><span class="s1">&#39;Predictions_Probas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;The United States and Russia maintain diplomatic and trade relations.&#39;, &#39;The relationship was generally warm under the Russian President Boris Yeltsin (1991–99) until the NATO bombing of the Federal Republic of Yugoslavia in the spring of 1999, and has since deteriorated significantly.&#39;, &#34;In 2014, relations greatly deteriorated further due to the crisis in Ukraine, Russia&#39;s annexation of Crimea in 2014, differences regarding Russian military intervention in the Syrian Civil War, and from the end of 2016 over Russia&#39;s alleged interference in the 2016 U.S. elections.&#34;, &#39;Mutual sanctions imposed in 2014 remain in place.&#39;]
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[0.9242598414421082,
 0.9835892915725708,
 0.01635131798684597,
 0.013922506012022495]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Incorrectly-classified-relationships">Incorrectly classified relationships<a class="anchor-link" href="#Incorrectly-classified-relationships"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="c1"># Sentences</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sent_all_df</span><span class="p">[</span><span class="n">sent_all_df</span><span class="p">[</span><span class="s1">&#39;Country_Pair&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;China_United States&#39;</span><span class="p">][</span><span class="s1">&#39;Summary_Sentence&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

<span class="c1"># Sentiment probabilities</span>
<span class="n">sent_all_df</span><span class="p">[</span><span class="n">sent_all_df</span><span class="p">[</span><span class="s1">&#39;Country_Pair&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;China_United States&#39;</span><span class="p">][</span><span class="s1">&#39;Predictions_Probas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#34;Despite tensions during his term, the Chinese population&#39;s favorability of the U.S. stood at 51% in Obama&#39;s last year of 2016, only to dip during the Trump Administration.&#34;, &#39;The relations deteriorated sharply under President Donald Trump, whose administration launched a trade war against China, banned US companies from selling equipment to Huawei, increased visa restrictions on Chinese nationality students and scholars and designated China as a &#34;currency manipulator&#34;.&#39;, &#39;During the Trump administration, and especially since the US-China trade war began, political observers have started to warn that a new cold war is emerging.&#39;, &#39;Michael D. Swaine warned in 2019, &#34;The often positive and optimistic forces, interests, and beliefs that sustained bilateral ties for decades are giving way to undue pessimism, hostility, and a zero-sum mindset in almost every area of engagement.&#34;&#39;, &#39;However by 2020, the two countries have started to take steps in order to repair the relations; U.S. lifted its currency manipulator designation on China in 13 January 2020, and both sides signed the US–China Phase One trade deal in 15 January.&#39;]
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[0.17708182334899902,
 0.7658159732818604,
 0.10857371240854263,
 0.7851555347442627,
 0.1416555643081665]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our model can definitely do better! It will be great if we could have more training data if time permits!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Visualizing-our-predictions!">Visualizing our predictions!<a class="anchor-link" href="#Visualizing-our-predictions!"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/fastpages/images/copied_from_nb/my_icons/geopolitical_mapper/visualization.JPG" alt="" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our aim in this section is for us to visualize the sentiments on a world map plot. We will allow a user to select a country to focus on. And the sentiments of its relationships with other countries will be displayed on the plot.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>By default we will <strong>allow the user to choose a country from column <code>Country_A</code></strong>. Currently our dataframe of predictions comprises of <strong>one-directional relationships</strong>. For example, if United States - China was represented in the dataframe, the China - United States relationship would be missing. Let's <strong>stack</strong> the dataframe we have currently, with another dataframe where the names in columns <code>Country_A</code> and <code>Country_B</code> are swapped.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Creating-a-stacked-dataframe">Creating a stacked dataframe<a class="anchor-link" href="#Creating-a-stacked-dataframe"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Great! Now all of our relationships are represented!</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">sent_all_swap_df</span> <span class="o">=</span> <span class="n">sent_all_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">sent_all_swap_df</span><span class="p">[</span><span class="s1">&#39;Country_A&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sent_all_df</span><span class="p">[</span><span class="s1">&#39;Country_B&#39;</span><span class="p">]</span>
<span class="n">sent_all_swap_df</span><span class="p">[</span><span class="s1">&#39;Country_B&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sent_all_df</span><span class="p">[</span><span class="s1">&#39;Country_A&#39;</span><span class="p">]</span>

<span class="n">sent_all_stack_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">sent_all_df</span><span class="p">,</span> <span class="n">sent_all_swap_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sent_all_stack_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Country_A&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">sent_all_stack_df</span><span class="p">[</span><span class="n">sent_all_stack_df</span><span class="p">[</span><span class="s1">&#39;Country_Pair&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;China_United States&#39;</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country_A</th>
      <th>Country_B</th>
      <th>Country_Pair</th>
      <th>Label</th>
      <th>Summary_Sentence</th>
      <th>Predictions_Probas</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2436</th>
      <td>China</td>
      <td>United States</td>
      <td>China_United States</td>
      <td>NaN</td>
      <td>China–United States relations (simplified Chin...</td>
      <td>0.651927</td>
    </tr>
    <tr>
      <th>2437</th>
      <td>China</td>
      <td>United States</td>
      <td>China_United States</td>
      <td>NaN</td>
      <td>The history of the relationship can be traced ...</td>
      <td>0.987907</td>
    </tr>
    <tr>
      <th>2438</th>
      <td>China</td>
      <td>United States</td>
      <td>China_United States</td>
      <td>NaN</td>
      <td>The relationship between the two countries hav...</td>
      <td>0.985974</td>
    </tr>
    <tr>
      <th>2439</th>
      <td>China</td>
      <td>United States</td>
      <td>China_United States</td>
      <td>NaN</td>
      <td>Both countries used to have an extremely exten...</td>
      <td>0.517934</td>
    </tr>
    <tr>
      <th>2440</th>
      <td>China</td>
      <td>United States</td>
      <td>China_United States</td>
      <td>NaN</td>
      <td>It is a relationship of economic cooperation, ...</td>
      <td>0.399313</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6048</th>
      <td>United States</td>
      <td>China</td>
      <td>China_United States</td>
      <td>NaN</td>
      <td>Despite tensions during his term, the Chinese ...</td>
      <td>0.177082</td>
    </tr>
    <tr>
      <th>6049</th>
      <td>United States</td>
      <td>China</td>
      <td>China_United States</td>
      <td>NaN</td>
      <td>The relations deteriorated sharply under Presi...</td>
      <td>0.765816</td>
    </tr>
    <tr>
      <th>6050</th>
      <td>United States</td>
      <td>China</td>
      <td>China_United States</td>
      <td>NaN</td>
      <td>During the Trump administration, and especiall...</td>
      <td>0.108574</td>
    </tr>
    <tr>
      <th>6051</th>
      <td>United States</td>
      <td>China</td>
      <td>China_United States</td>
      <td>NaN</td>
      <td>Michael D. Swaine warned in 2019, "The often p...</td>
      <td>0.785156</td>
    </tr>
    <tr>
      <th>6052</th>
      <td>United States</td>
      <td>China</td>
      <td>China_United States</td>
      <td>NaN</td>
      <td>However by 2020, the two countries have starte...</td>
      <td>0.141656</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 6 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Calculating-the-average-sentiment-score">Calculating the average sentiment score<a class="anchor-link" href="#Calculating-the-average-sentiment-score"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we have calculated the sentiment score at a sentence level,we will use pandas' <code>groupby</code> to <strong>average the sentiment score</strong> for each country pair.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">sent_all_stack_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Country_Pair&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()[</span><span class="s1">&#39;Predictions_Probas&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Country_Pair
Abkhazia_Nauru           0.938478
Abkhazia_Nicaragua       0.757214
Abkhazia_Tuvalu          0.961020
Abkhazia_Vanuatu         0.523380
Afghanistan_China        0.813562
                           ...   
United States_Vietnam    0.910205
United States_Yemen      0.086554
United States_Zambia     0.740769
Yemen_European Union     0.984979
Zambia_Zimbabwe          0.635722
Name: Predictions_Probas, Length: 1171, dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Retrieving-the-ISO-code-for-each-country">Retrieving the ISO code for each country<a class="anchor-link" href="#Retrieving-the-ISO-code-for-each-country"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Plotly, the visualization package that we will be using, <strong>identifies each country's location on the world map by using the ISO code.</strong> We can easily retrieve the ISO codes in the form of a txt file from the web. However, once again, the names of the countries used in the ISO codes txt file might be different from what we have in the dataframe.</p>
<p>Fret not! <code>get_std_names</code> is here to save the day. We will map the names of the countries in the txt file to obtain its standardized <code>std</code> names.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">country_ISO_raw_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./data/Wiki/country_ISO.txt&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;  &quot;</span><span class="p">,</span>
                                 <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ISO_Code&#39;</span><span class="p">,</span> <span class="s1">&#39;Country&#39;</span><span class="p">])</span>

<span class="n">country_ISO_df</span> <span class="o">=</span> <span class="n">get_std_names</span><span class="p">(</span><span class="n">country_ISO_raw_df</span><span class="p">,</span>
                               <span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="n">alt_names_to_countries</span><span class="p">)</span>

<span class="n">country_ISO_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:2: ParserWarning: Falling back to the &#39;python&#39; engine because the &#39;c&#39; engine does not support regex separators (separators &gt; 1 char and different from &#39;\s+&#39; are interpreted as regex); you can avoid this warning by specifying engine=&#39;python&#39;.
  
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ISO_Code</th>
      <th>Country</th>
      <th>Country_Std</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>AFG</td>
      <td>Afghanistan</td>
      <td>afghanistan</td>
    </tr>
    <tr>
      <th>5</th>
      <td>ALB</td>
      <td>Albania</td>
      <td>albania</td>
    </tr>
    <tr>
      <th>64</th>
      <td>DZA</td>
      <td>Algeria</td>
      <td>algeria</td>
    </tr>
    <tr>
      <th>10</th>
      <td>ASM</td>
      <td>American Samoa</td>
      <td>american_samoa</td>
    </tr>
    <tr>
      <th>6</th>
      <td>AND</td>
      <td>Andorra</td>
      <td>andorra</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AGO</td>
      <td>Angola</td>
      <td>angola</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AIA</td>
      <td>Anguilla</td>
      <td>anguilla</td>
    </tr>
    <tr>
      <th>11</th>
      <td>ATA</td>
      <td>Antarctica</td>
      <td>antarctica</td>
    </tr>
    <tr>
      <th>13</th>
      <td>ATG</td>
      <td>Antigua and Barbuda</td>
      <td>antigua_and_barbuda</td>
    </tr>
    <tr>
      <th>8</th>
      <td>ARG</td>
      <td>Argentina</td>
      <td>argentina</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will convert the dataframe into a dictionary for faster mappings.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">country_to_ISO</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">country_ISO_df</span><span class="p">[</span><span class="s1">&#39;Country_Std&#39;</span><span class="p">],</span> \
                                     <span class="n">country_ISO_df</span><span class="p">[</span><span class="s1">&#39;ISO_Code&#39;</span><span class="p">])}</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's create an additional column in our <code>sent_all_stack_df</code> to populate the ISO codes of the countries.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="k">def</span> <span class="nf">get_ISO</span><span class="p">(</span><span class="n">country</span><span class="p">):</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">ISO</span> <span class="o">=</span> <span class="n">country_to_ISO</span><span class="p">[</span><span class="n">country</span><span class="p">]</span>
  <span class="k">except</span><span class="p">:</span>
    <span class="n">ISO</span> <span class="o">=</span> <span class="s1">&#39;Not Available&#39;</span>

  <span class="k">return</span> <span class="n">ISO</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">sent_all_stack_df</span> <span class="o">=</span> <span class="n">get_std_names</span><span class="p">(</span><span class="n">sent_all_stack_df</span><span class="p">,</span> <span class="s1">&#39;Country_A&#39;</span><span class="p">,</span> \
                                  <span class="n">alt_names_to_countries</span><span class="p">)</span>

<span class="n">sent_all_stack_df</span> <span class="o">=</span> <span class="n">get_std_names</span><span class="p">(</span><span class="n">sent_all_stack_df</span><span class="p">,</span> <span class="s1">&#39;Country_B&#39;</span><span class="p">,</span> \
                                  <span class="n">alt_names_to_countries</span><span class="p">)</span>

<span class="n">sent_all_stack_df</span><span class="p">[</span><span class="s1">&#39;country_A_ISO&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sent_all_stack_df</span><span class="p">[</span><span class="s1">&#39;Country_A_Std&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_ISO</span><span class="p">)</span>
<span class="n">sent_all_stack_df</span><span class="p">[</span><span class="s1">&#39;country_B_ISO&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sent_all_stack_df</span><span class="p">[</span><span class="s1">&#39;Country_B_Std&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_ISO</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will exclude countries with no ISO codes for now.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">sent_all_stack_avail_df</span> <span class="o">=</span> <span class="n">sent_all_stack_df</span><span class="p">[</span><span class="n">sent_all_stack_df</span><span class="p">[</span><span class="s1">&#39;country_A_ISO&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;Not Available&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Time-to-visualize-the-sentiments!">Time to visualize the sentiments!<a class="anchor-link" href="#Time-to-visualize-the-sentiments!"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/fastpages/images/copied_from_nb/my_icons/geopolitical_mapper/finally_over_obama.JPG" alt="" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here are countries that we can choose from.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">sent_all_stack_avail_df</span><span class="p">[</span><span class="s1">&#39;Country_A_Std&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([&#39;afghanistan&#39;, &#39;albania&#39;, &#39;algeria&#39;, &#39;andorra&#39;, &#39;angola&#39;,
       &#39;antigua_and_barbuda&#39;, &#39;argentina&#39;, &#39;armenia&#39;, &#39;australia&#39;,
       &#39;austria&#39;, &#39;azerbaijan&#39;, &#39;bahamas&#39;, &#39;bahrain&#39;, &#39;bangladesh&#39;,
       &#39;barbados&#39;, &#39;belarus&#39;, &#39;belgium&#39;, &#39;belize&#39;, &#39;benin&#39;, &#39;bhutan&#39;,
       &#39;bolivia&#39;, &#39;bosnia_and_herzegovina&#39;, &#39;botswana&#39;, &#39;brazil&#39;,
       &#39;bulgaria&#39;, &#39;burkina_faso&#39;, &#39;burundi&#39;, &#39;cambodia&#39;, &#39;cameroon&#39;,
       &#39;canada&#39;, &#39;cape_verde&#39;, &#39;central_african_republic&#39;, &#39;chad&#39;,
       &#39;chile&#39;, &#39;china&#39;, &#39;colombia&#39;, &#39;comoros&#39;, &#39;costa_rica&#39;, &#39;croatia&#39;,
       &#39;cuba&#39;, &#39;cyprus&#39;, &#39;czech_republic&#39;, &#39;denmark&#39;, &#39;djibouti&#39;,
       &#39;dominica&#39;, &#39;dominican_republic&#39;, &#39;east_timor&#39;, &#39;ecuador&#39;, &#39;egypt&#39;,
       &#39;el_salvador&#39;, &#39;equatorial_guinea&#39;, &#39;eritrea&#39;, &#39;estonia&#39;,
       &#39;eswatini&#39;, &#39;ethiopia&#39;, &#39;fiji&#39;, &#39;finland&#39;, &#39;france&#39;, &#39;gabon&#39;,
       &#39;gambia&#39;, &#39;georgia&#39;, &#39;germany&#39;, &#39;ghana&#39;, &#39;greece&#39;, &#39;grenada&#39;,
       &#39;guatemala&#39;, &#39;guinea-bissau&#39;, &#39;guyana&#39;, &#39;haiti&#39;, &#39;holy_see&#39;,
       &#39;honduras&#39;, &#39;hungary&#39;, &#39;iceland&#39;, &#39;india&#39;, &#39;indonesia&#39;, &#39;iran&#39;,
       &#39;iraq&#39;, &#39;ireland&#39;, &#39;israel&#39;, &#39;italy&#39;, &#39;ivory_coast&#39;, &#39;jamaica&#39;,
       &#39;japan&#39;, &#39;jordan&#39;, &#39;kazakhstan&#39;, &#39;kenya&#39;, &#39;kiribati&#39;, &#39;kuwait&#39;,
       &#39;kyrgyzstan&#39;, &#39;latvia&#39;, &#39;lebanon&#39;, &#39;lesotho&#39;, &#39;liberia&#39;, &#39;libya&#39;,
       &#39;liechtenstein&#39;, &#39;lithuania&#39;, &#39;luxembourg&#39;, &#39;madagascar&#39;, &#39;malawi&#39;,
       &#39;malaysia&#39;, &#39;maldives&#39;, &#39;mali&#39;, &#39;malta&#39;, &#39;marshall_islands&#39;,
       &#39;mauritania&#39;, &#39;mauritius&#39;, &#39;mexico&#39;, &#39;moldova&#39;, &#39;monaco&#39;,
       &#39;mongolia&#39;, &#39;montenegro&#39;, &#39;morocco&#39;, &#39;mozambique&#39;, &#39;myanmar&#39;,
       &#39;namibia&#39;, &#39;nauru&#39;, &#39;nepal&#39;, &#39;netherlands&#39;, &#39;new_zealand&#39;,
       &#39;nicaragua&#39;, &#39;niger&#39;, &#39;nigeria&#39;, &#39;north_macedonia&#39;, &#39;norway&#39;,
       &#39;oman&#39;, &#39;pakistan&#39;, &#39;palau&#39;, &#39;panama&#39;, &#39;papua_new_guinea&#39;,
       &#39;paraguay&#39;, &#39;peru&#39;, &#39;philippines&#39;, &#39;poland&#39;, &#39;portugal&#39;, &#39;qatar&#39;,
       &#39;republic_of_congo&#39;, &#39;romania&#39;, &#39;russia&#39;, &#39;rwanda&#39;, &#39;saint_lucia&#39;,
       &#39;saint_vincent_and_grenadines&#39;, &#39;samoa&#39;, &#39;san_marino&#39;,
       &#39;saudi_arabia&#39;, &#39;senegal&#39;, &#39;serbia&#39;, &#39;seychelles&#39;, &#39;sierra_leone&#39;,
       &#39;singapore&#39;, &#39;slovakia&#39;, &#39;slovenia&#39;, &#39;solomon_islands&#39;, &#39;somalia&#39;,
       &#39;south_africa&#39;, &#39;south_korea&#39;, &#39;south_sudan&#39;, &#39;spain&#39;, &#39;sri_lanka&#39;,
       &#39;sudan&#39;, &#39;suriname&#39;, &#39;sweden&#39;, &#39;switzerland&#39;, &#39;taiwan&#39;,
       &#39;tajikistan&#39;, &#39;tanzania&#39;, &#39;thailand&#39;, &#39;togo&#39;, &#39;tonga&#39;,
       &#39;trinidad_and_tobago&#39;, &#39;tunisia&#39;, &#39;turkey&#39;, &#39;turkmenistan&#39;,
       &#39;tuvalu&#39;, &#39;uganda&#39;, &#39;ukraine&#39;, &#39;united_arab_emirates&#39;,
       &#39;united_kingdom&#39;, &#39;united_states&#39;, &#39;uruguay&#39;, &#39;uzbekistan&#39;,
       &#39;vanuatu&#39;, &#39;venezuela&#39;, &#39;vietnam&#39;, &#39;yemen&#39;, &#39;zambia&#39;, &#39;zimbabwe&#39;],
      dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For illustration purposes, let's select <strong>"united_states"</strong>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p><div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse-hide</span>
<span class="n">country</span> <span class="o">=</span> <span class="s2">&quot;united_states&quot;</span>
<span class="n">sent_country_df</span> <span class="o">=</span> <span class="n">sent_all_stack_avail_df</span><span class="p">[</span><span class="n">sent_all_stack_avail_df</span><span class="p">[</span><span class="s1">&#39;Country_A_Std&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">country</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>
</p>
    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With the help of Plotly, we are able to illustrate the sentiments on a world map.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># https://plot.ly/python/bubble-maps/</span>

<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter_geo</span><span class="p">(</span><span class="n">sent_country_df</span><span class="p">,</span>
                     <span class="n">locations</span><span class="o">=</span><span class="s2">&quot;country_B_ISO&quot;</span><span class="p">,</span>
                     <span class="n">color</span><span class="o">=</span><span class="s2">&quot;Predictions_Probas&quot;</span><span class="p">,</span>
                     <span class="n">hover_name</span><span class="o">=</span><span class="s2">&quot;Country_B_Std&quot;</span><span class="p">,</span>
                     <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;natural earth&quot;</span><span class="p">)</span>

<span class="c1"># To show smaller countries</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">({</span>
    <span class="s1">&#39;geo&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;resolution&#39;</span><span class="p">:</span> <span class="mi">50</span>
    <span class="p">}</span>
<span class="p">})</span>


<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>WARNING:tensorflow:Unresolved object in checkpoint: (root).optimizer.iter
WARNING:tensorflow:A checkpoint was restored (e.g. tf.train.Checkpoint.restore or tf.keras.Model.load_weights) but not all checkpointed values were used. See above for specific issues. Use expect_partial() on the load status object, e.g. tf.train.Checkpoint.restore(...).expect_partial(), to silence these warnings, or use assert_consumed() to make the check explicit. See https://www.tensorflow.org/alpha/guide/checkpoints#loading_mechanics for details.
WARNING:tensorflow:Unresolved object in checkpoint: (root).optimizer.iter
WARNING:tensorflow:A checkpoint was restored (e.g. tf.train.Checkpoint.restore or tf.keras.Model.load_weights) but not all checkpointed values were used. See above for specific issues. Use expect_partial() on the load status object, e.g. tf.train.Checkpoint.restore(...).expect_partial(), to silence these warnings, or use assert_consumed() to make the check explicit. See https://www.tensorflow.org/alpha/guide/checkpoints#loading_mechanics for details.
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>
                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>    
            <div id="89bb0340-092e-4b1b-a377-dfe9270224ae" class="plotly-graph-div" style="height:525px; width:100%;"></div>
            <script type="text/javascript">
                
                    window.PLOTLYENV=window.PLOTLYENV || {};
                    
                if (document.getElementById("89bb0340-092e-4b1b-a377-dfe9270224ae")) {
                    Plotly.newPlot(
                        '89bb0340-092e-4b1b-a377-dfe9270224ae',
                        [{"geo": "geo", "hoverlabel": {"namelength": 0}, "hovertemplate": "<b>%{hovertext}</b><br><br>country_B_ISO=%{location}<br>Predictions_Probas=%{marker.color}", "hovertext": ["uzbekistan", "uzbekistan", "uzbekistan", "uzbekistan", "uzbekistan", "uzbekistan", "uzbekistan", "uzbekistan", "yemen", "yemen", "yemen", "vanuatu", "vanuatu", "vanuatu", "zambia", "zambia", "zambia", "zambia", "zambia", "zambia", "zambia", "zambia", "zambia", "vietnam", "vietnam", "vietnam", "vietnam", "vietnam", "vietnam", "vietnam", "vietnam", "vietnam", "vietnam", "venezuela", "venezuela", "venezuela", "venezuela", "venezuela", "venezuela", "venezuela", "venezuela", "venezuela", "venezuela", "venezuela", "uruguay", "russia", "russia", "russia", "russia", "iraq", "iraq", "iraq", "iraq", "iraq", "iraq", "iceland", "libya", "libya", "libya", "libya", "libya", "libya", "libya", "libya", "japan", "japan", "japan", "japan", "japan", "japan", "japan", "japan", "japan", "japan", "japan", "japan", "japan", "japan", "japan", "japan", "japan", "japan", "japan", "japan", "japan", "slovakia", "senegal", "senegal", "montenegro", "montenegro", "kuwait", "kuwait", "burkina_faso", "burkina_faso", "israel", "israel", "israel", "israel", "israel", "israel", "israel", "israel", "israel", "israel", "israel", "israel", "israel", "israel", "israel", "grenada", "grenada", "philippines", "philippines", "philippines", "philippines", "philippines", "philippines", "france", "france", "france", "france", "france", "france", "france", "france", "central_african_republic", "nigeria", "nigeria", "nigeria", "nigeria", "nigeria", "nigeria", "nigeria", "nigeria", "nigeria", "nigeria", "nigeria", "nigeria", "nigeria", "nigeria", "nigeria", "nigeria", "laos", "laos", "azerbaijan", "hungary", "singapore", "singapore", "niger", "tonga", "tonga", "tonga", "tonga", "tonga", "tonga", "tonga", "tonga", "tonga", "tonga", "tonga", "tonga", "tonga", "tonga", "tonga", "south_africa", "south_africa", "south_africa", "south_africa", "united_kingdom", "united_kingdom", "united_kingdom", "united_kingdom", "united_kingdom", "united_kingdom", "united_kingdom", "united_kingdom", "united_kingdom", "united_kingdom", "united_kingdom", "united_kingdom", "bulgaria", "bulgaria", "lebanon", "lebanon", "lebanon", "lebanon", "jordan", "jordan", "serbia", "serbia", "serbia", "serbia", "serbia", "serbia", "serbia", "serbia", "serbia", "serbia", "serbia", "serbia", "serbia", "serbia", "serbia", "serbia", "guinea-bissau", "malaysia", "malaysia", "malaysia", "malaysia", "malaysia", "malaysia", "malaysia", "malaysia", "malaysia", "malaysia", "finland", "cuba", "cuba", "cuba", "cuba", "cuba", "cuba", "cuba", "cuba", "cuba", "cuba", "cuba", "cuba", "cuba", "cuba", "cuba", "cuba", "dominican_republic", "south_korea", "south_korea", "south_korea", "south_korea", "south_korea", "south_korea", "south_korea", "south_korea", "south_korea", "south_korea", "south_korea", "tunisia", "malta", "malta", "estonia", "estonia", "estonia", "estonia", "sudan", "bhutan", "bhutan", "bhutan", "bhutan", "peru", "peru", "peru", "peru", "peru", "kazakhstan", "kazakhstan", "kazakhstan", "kazakhstan", "kazakhstan", "kazakhstan", "kazakhstan", "kazakhstan", "kazakhstan", "kazakhstan", "kazakhstan", "kazakhstan", "kazakhstan", "kazakhstan", "kazakhstan", "kazakhstan", "kazakhstan", "kazakhstan", "kazakhstan", "kazakhstan", "kazakhstan", "kazakhstan", "el_salvador", "el_salvador", "ireland", "ireland", "ireland", "ireland", "ireland", "ireland", "oman", "oman", "austria", "austria", "austria", "austria", "mali", "mali", "mali", "mali", "guinea-bissau", "haiti", "argentina", "argentina", "argentina", "argentina", "argentina", "guatemala", "guatemala", "guatemala", "guatemala", "guatemala", "ivory_coast", "qatar", "iran", "iran", "iran", "iran", "iran", "iran", "iran", "iran", "iran", "iran", "iran", "iran", "iran", "iran", "iran", "iran", "iran", "iran", "iran", "iran", "iran", "s\u00e3o_tom\u00e9_and_pr\u00edncipe", "s\u00e3o_tom\u00e9_and_pr\u00edncipe", "s\u00e3o_tom\u00e9_and_pr\u00edncipe", "s\u00e3o_tom\u00e9_and_pr\u00edncipe", "croatia", "croatia", "croatia", "croatia", "croatia", "croatia", "croatia", "croatia", "croatia", "croatia", "india", "india", "india", "india", "india", "india", "india", "india", "india", "india", "india", "india", "india", "india", "japan", "japan", "japan", "japan", "japan", "japan", "japan", "japan", "japan", "japan", "japan", "japan", "japan", "japan", "japan", "japan", "japan", "japan", "japan", "japan", "japan", "new_zealand", "new_zealand", "new_zealand", "new_zealand", "new_zealand", "new_zealand", "pakistan", "pakistan", "pakistan", "pakistan", "pakistan", "pakistan", "pakistan", "pakistan", "pakistan", "pakistan", "pakistan", "pakistan", "pakistan", "pakistan", "pakistan", "pakistan", "pakistan", "pakistan", "mongolia", "mongolia", "canada", "canada", "canada", "canada", "canada", "canada", "canada", "canada", "canada", "canada", "canada", "canada", "canada", "canada", "canada", "canada", "canada", "canada", "canada", "canada", "canada", "canada", "canada", "canada", "canada", "canada", "canada", "israel", "israel", "israel", "israel", "israel", "israel", "israel", "israel", "israel", "israel", "israel", "israel", "israel", "israel", "israel", "kenya", "kenya", "kenya", "kenya", "kenya", "kenya", "kenya", "kenya", "kenya", "kenya", "kenya", "rwanda", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "brazil", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "albania", "fiji", "fiji", "bahrain", "bahrain", "saint_lucia", "panama", "germany", "germany", "portugal", "united_kingdom", "united_kingdom", "united_kingdom", "united_kingdom", "united_kingdom", "united_kingdom", "united_kingdom", "united_kingdom", "united_kingdom", "united_kingdom", "united_kingdom", "united_kingdom", "somalia", "somalia", "belgium", "belgium", "belgium", "botswana", "botswana", "united_arab_emirates", "united_arab_emirates", "united_arab_emirates", "denmark", "denmark", "denmark", "denmark", "chile", "chile", "chile", "chile", "chile", "chile", "chile", "chile", "chile", "togo", "togo", "togo", "togo", "togo", "togo", "togo", "togo", "togo", "togo", "togo", "togo", "togo", "togo", "togo", "togo", "togo", "moldova", "moldova", "italy", "italy", "italy", "italy", "italy", "italy", "italy", "italy", "italy", "italy", "italy", "italy", "comoros", "georgia", "georgia", "georgia", "georgia", "georgia", "georgia", "georgia", "georgia", "georgia", "brunei", "brunei", "brunei", "brunei", "eritrea", "chad", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "australia", "australia", "australia", "australia", "australia", "australia", "australia", "australia", "australia", "australia", "australia", "australia", "australia", "egypt", "egypt", "egypt", "egypt", "mauritius", "mauritius", "mauritius", "mauritius", "mauritius", "mauritius", "mauritius", "mauritius", "mauritius", "mauritius", "mauritius", "mauritius", "mauritius", "mauritius", "mauritius", "mauritius", "mauritius", "mauritius", "mauritius", "mauritius", "mauritius", "uganda", "angola", "cambodia", "cambodia", "cambodia", "cambodia", "cambodia", "turkey", "turkey", "turkey", "turkey", "turkey", "turkey", "turkey", "turkey", "ecuador", "ecuador", "ecuador", "ecuador", "ecuador", "ecuador", "ecuador", "ecuador", "poland", "poland", "poland", "poland", "russia", "russia", "russia", "russia", "saint_vincent_and_grenadines", "saint_vincent_and_grenadines", "saint_vincent_and_grenadines", "saint_vincent_and_grenadines", "saint_vincent_and_grenadines", "saint_vincent_and_grenadines", "saint_vincent_and_grenadines", "saint_vincent_and_grenadines", "saint_vincent_and_grenadines", "saint_vincent_and_grenadines", "saint_vincent_and_grenadines", "ghana", "ghana", "ghana", "ghana", "ghana", "belarus", "belarus", "belarus", "belarus", "belarus", "sweden", "sweden", "sweden", "sweden", "sweden", "costa_rica", "costa_rica", "costa_rica", "costa_rica", "india", "india", "india", "india", "india", "india", "india", "india", "india", "india", "india", "india", "india", "india", "greece", "greece", "greece", "greece", "greece", "greece", "greece", "greece", "mexico", "mexico", "mexico", "mexico", "mexico", "mexico", "mexico", "mexico", "mexico", "mexico", "mexico", "mexico", "mexico", "mexico", "mexico", "mexico", "mexico", "thailand", "thailand", "thailand", "thailand", "thailand", "myanmar", "myanmar", "myanmar", "myanmar", "myanmar", "myanmar", "benin", "benin", "benin", "ukraine", "ukraine", "ukraine", "ukraine", "ukraine", "ukraine", "ukraine", "ukraine", "ukraine", "barbados", "barbados", "barbados", "barbados", "sri_lanka", "sri_lanka", "bangladesh", "bangladesh", "bangladesh", "bangladesh", "bangladesh", "holy_see", "holy_see", "holy_see", "holy_see", "sudan", "romania", "romania", "romania", "romania", "romania", "romania", "romania", "romania", "romania", "republic_of_congo", "republic_of_congo", "republic_of_congo", "republic_of_congo", "republic_of_congo", "indonesia", "indonesia", "indonesia", "indonesia", "indonesia", "indonesia", "netherlands", "netherlands", "netherlands", "netherlands", "afghanistan", "afghanistan", "afghanistan", "afghanistan", "afghanistan", "morocco", "morocco", "morocco", "morocco", "morocco", "morocco", "morocco", "morocco", "morocco", "lithuania", "lithuania", "lithuania", "nepal", "nepal", "colombia", "colombia", "colombia", "colombia", "colombia", "colombia", "colombia", "colombia", "colombia", "colombia", "colombia", "colombia", "cuba", "cuba", "cuba", "cuba", "cuba", "cuba", "cuba", "cuba", "cuba", "cuba", "cuba", "cuba", "cuba", "cuba", "cuba", "cuba", "honduras", "honduras", "honduras", "honduras", "honduras", "honduras", "honduras", "honduras", "honduras", "honduras", "honduras", "spain", "spain", "spain", "spain", "spain", "spain", "spain", "spain", "east_timor", "iran", "iran", "iran", "iran", "iran", "iran", "iran", "iran", "iran", "iran", "iran", "iran", "iran", "iran", "iran", "iran", "iran", "iran", "iran", "iran", "iran", "norway", "norway", "norway", "norway", "norway", "norway", "norway", "norway", "norway", "norway", "norway", "norway", "norway", "bosnia_and_herzegovina", "bosnia_and_herzegovina", "bosnia_and_herzegovina", "bosnia_and_herzegovina", "bosnia_and_herzegovina", "bosnia_and_herzegovina", "cyprus", "cyprus", "malawi", "malawi", "malawi", "malawi", "malawi", "malawi", "malawi", "malawi", "malawi", "malawi", "malawi", "malawi", "pakistan", "pakistan", "pakistan", "pakistan", "pakistan", "pakistan", "pakistan", "pakistan", "pakistan", "pakistan", "pakistan", "pakistan", "pakistan", "pakistan", "pakistan", "pakistan", "pakistan", "pakistan", "algeria", "algeria", "algeria", "algeria", "algeria", "algeria", "palau", "palau", "belize", "belize", "belize", "belize", "belize", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "china", "tajikistan", "paraguay", "trinidad_and_tobago", "trinidad_and_tobago", "trinidad_and_tobago", "trinidad_and_tobago", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia", "saudi_arabia"], "legendgroup": "", "locations": ["UZB", "UZB", "UZB", "UZB", "UZB", "UZB", "UZB", "UZB", "YEM", "YEM", "YEM", "VUT", "VUT", "VUT", "ZMB", "ZMB", "ZMB", "ZMB", "ZMB", "ZMB", "ZMB", "ZMB", "ZMB", "VNM", "VNM", "VNM", "VNM", "VNM", "VNM", "VNM", "VNM", "VNM", "VNM", "VEN", "VEN", "VEN", "VEN", "VEN", "VEN", "VEN", "VEN", "VEN", "VEN", "VEN", "URY", "RUS", "RUS", "RUS", "RUS", "IRQ", "IRQ", "IRQ", "IRQ", "IRQ", "IRQ", "ISL", "LBY", "LBY", "LBY", "LBY", "LBY", "LBY", "LBY", "LBY", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "SVK", "SEN", "SEN", "MNE", "MNE", "KWT", "KWT", "BFA", "BFA", "ISR", "ISR", "ISR", "ISR", "ISR", "ISR", "ISR", "ISR", "ISR", "ISR", "ISR", "ISR", "ISR", "ISR", "ISR", "GRD", "GRD", "PHL", "PHL", "PHL", "PHL", "PHL", "PHL", "FRA", "FRA", "FRA", "FRA", "FRA", "FRA", "FRA", "FRA", "CAF", "NGA", "NGA", "NGA", "NGA", "NGA", "NGA", "NGA", "NGA", "NGA", "NGA", "NGA", "NGA", "NGA", "NGA", "NGA", "NGA", "Not Available", "Not Available", "AZE", "HUN", "SGP", "SGP", "NER", "TON", "TON", "TON", "TON", "TON", "TON", "TON", "TON", "TON", "TON", "TON", "TON", "TON", "TON", "TON", "ZAF", "ZAF", "ZAF", "ZAF", "GBR", "GBR", "GBR", "GBR", "GBR", "GBR", "GBR", "GBR", "GBR", "GBR", "GBR", "GBR", "BGR", "BGR", "LBN", "LBN", "LBN", "LBN", "JOR", "JOR", "SRB", "SRB", "SRB", "SRB", "SRB", "SRB", "SRB", "SRB", "SRB", "SRB", "SRB", "SRB", "SRB", "SRB", "SRB", "SRB", "GNB", "MYS", "MYS", "MYS", "MYS", "MYS", "MYS", "MYS", "MYS", "MYS", "MYS", "FIN", "CUB", "CUB", "CUB", "CUB", "CUB", "CUB", "CUB", "CUB", "CUB", "CUB", "CUB", "CUB", "CUB", "CUB", "CUB", "CUB", "DOM", "PRK", "PRK", "PRK", "PRK", "PRK", "PRK", "PRK", "PRK", "PRK", "PRK", "PRK", "TUN", "MLT", "MLT", "EST", "EST", "EST", "EST", "SDN", "BTN", "BTN", "BTN", "BTN", "PER", "PER", "PER", "PER", "PER", "KAZ", "KAZ", "KAZ", "KAZ", "KAZ", "KAZ", "KAZ", "KAZ", "KAZ", "KAZ", "KAZ", "KAZ", "KAZ", "KAZ", "KAZ", "KAZ", "KAZ", "KAZ", "KAZ", "KAZ", "KAZ", "KAZ", "SLV", "SLV", "IRL", "IRL", "IRL", "IRL", "IRL", "IRL", "OMN", "OMN", "AUT", "AUT", "AUT", "AUT", "MLI", "MLI", "MLI", "MLI", "GNB", "HTI", "ARG", "ARG", "ARG", "ARG", "ARG", "GTM", "GTM", "GTM", "GTM", "GTM", "CIV", "QAT", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "Not Available", "Not Available", "Not Available", "Not Available", "HRV", "HRV", "HRV", "HRV", "HRV", "HRV", "HRV", "HRV", "HRV", "HRV", "IND", "IND", "IND", "IND", "IND", "IND", "IND", "IND", "IND", "IND", "IND", "IND", "IND", "IND", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "JPN", "NZL", "NZL", "NZL", "NZL", "NZL", "NZL", "PAK", "PAK", "PAK", "PAK", "PAK", "PAK", "PAK", "PAK", "PAK", "PAK", "PAK", "PAK", "PAK", "PAK", "PAK", "PAK", "PAK", "PAK", "MNG", "MNG", "CAN", "CAN", "CAN", "CAN", "CAN", "CAN", "CAN", "CAN", "CAN", "CAN", "CAN", "CAN", "CAN", "CAN", "CAN", "CAN", "CAN", "CAN", "CAN", "CAN", "CAN", "CAN", "CAN", "CAN", "CAN", "CAN", "CAN", "ISR", "ISR", "ISR", "ISR", "ISR", "ISR", "ISR", "ISR", "ISR", "ISR", "ISR", "ISR", "ISR", "ISR", "ISR", "KEN", "KEN", "KEN", "KEN", "KEN", "KEN", "KEN", "KEN", "KEN", "KEN", "KEN", "RWA", "BRA", "BRA", "BRA", "BRA", "BRA", "BRA", "BRA", "BRA", "BRA", "BRA", "BRA", "BRA", "BRA", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "ALB", "FJI", "FJI", "BHR", "BHR", "LCA", "PAN", "DEU", "DEU", "PRT", "GBR", "GBR", "GBR", "GBR", "GBR", "GBR", "GBR", "GBR", "GBR", "GBR", "GBR", "GBR", "SOM", "SOM", "BEL", "BEL", "BEL", "BWA", "BWA", "ARE", "ARE", "ARE", "DNK", "DNK", "DNK", "DNK", "CHL", "CHL", "CHL", "CHL", "CHL", "CHL", "CHL", "CHL", "CHL", "TGO", "TGO", "TGO", "TGO", "TGO", "TGO", "TGO", "TGO", "TGO", "TGO", "TGO", "TGO", "TGO", "TGO", "TGO", "TGO", "TGO", "MDA", "MDA", "ITA", "ITA", "ITA", "ITA", "ITA", "ITA", "ITA", "ITA", "ITA", "ITA", "ITA", "ITA", "COM", "GEO", "GEO", "GEO", "GEO", "GEO", "GEO", "GEO", "GEO", "GEO", "Not Available", "Not Available", "Not Available", "Not Available", "ERI", "TCD", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "AUS", "AUS", "AUS", "AUS", "AUS", "AUS", "AUS", "AUS", "AUS", "AUS", "AUS", "AUS", "AUS", "EGY", "EGY", "EGY", "EGY", "MUS", "MUS", "MUS", "MUS", "MUS", "MUS", "MUS", "MUS", "MUS", "MUS", "MUS", "MUS", "MUS", "MUS", "MUS", "MUS", "MUS", "MUS", "MUS", "MUS", "MUS", "UGA", "AGO", "KHM", "KHM", "KHM", "KHM", "KHM", "TUR", "TUR", "TUR", "TUR", "TUR", "TUR", "TUR", "TUR", "ECU", "ECU", "ECU", "ECU", "ECU", "ECU", "ECU", "ECU", "POL", "POL", "POL", "POL", "RUS", "RUS", "RUS", "RUS", "VCT", "VCT", "VCT", "VCT", "VCT", "VCT", "VCT", "VCT", "VCT", "VCT", "VCT", "GHA", "GHA", "GHA", "GHA", "GHA", "BLR", "BLR", "BLR", "BLR", "BLR", "SWE", "SWE", "SWE", "SWE", "SWE", "CRI", "CRI", "CRI", "CRI", "IND", "IND", "IND", "IND", "IND", "IND", "IND", "IND", "IND", "IND", "IND", "IND", "IND", "IND", "GRC", "GRC", "GRC", "GRC", "GRC", "GRC", "GRC", "GRC", "MEX", "MEX", "MEX", "MEX", "MEX", "MEX", "MEX", "MEX", "MEX", "MEX", "MEX", "MEX", "MEX", "MEX", "MEX", "MEX", "MEX", "THA", "THA", "THA", "THA", "THA", "MMR", "MMR", "MMR", "MMR", "MMR", "MMR", "BEN", "BEN", "BEN", "UKR", "UKR", "UKR", "UKR", "UKR", "UKR", "UKR", "UKR", "UKR", "BRB", "BRB", "BRB", "BRB", "LKA", "LKA", "BGD", "BGD", "BGD", "BGD", "BGD", "VAT", "VAT", "VAT", "VAT", "SDN", "ROU", "ROU", "ROU", "ROU", "ROU", "ROU", "ROU", "ROU", "ROU", "COG", "COG", "COG", "COG", "COG", "IDN", "IDN", "IDN", "IDN", "IDN", "IDN", "NLD", "NLD", "NLD", "NLD", "AFG", "AFG", "AFG", "AFG", "AFG", "MAR", "MAR", "MAR", "MAR", "MAR", "MAR", "MAR", "MAR", "MAR", "LTU", "LTU", "LTU", "NPL", "NPL", "COL", "COL", "COL", "COL", "COL", "COL", "COL", "COL", "COL", "COL", "COL", "COL", "CUB", "CUB", "CUB", "CUB", "CUB", "CUB", "CUB", "CUB", "CUB", "CUB", "CUB", "CUB", "CUB", "CUB", "CUB", "CUB", "HND", "HND", "HND", "HND", "HND", "HND", "HND", "HND", "HND", "HND", "HND", "ESP", "ESP", "ESP", "ESP", "ESP", "ESP", "ESP", "ESP", "TLS", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "IRN", "NOR", "NOR", "NOR", "NOR", "NOR", "NOR", "NOR", "NOR", "NOR", "NOR", "NOR", "NOR", "NOR", "BIH", "BIH", "BIH", "BIH", "BIH", "BIH", "CYP", "CYP", "MWI", "MWI", "MWI", "MWI", "MWI", "MWI", "MWI", "MWI", "MWI", "MWI", "MWI", "MWI", "PAK", "PAK", "PAK", "PAK", "PAK", "PAK", "PAK", "PAK", "PAK", "PAK", "PAK", "PAK", "PAK", "PAK", "PAK", "PAK", "PAK", "PAK", "DZA", "DZA", "DZA", "DZA", "DZA", "DZA", "PLW", "PLW", "BLZ", "BLZ", "BLZ", "BLZ", "BLZ", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "CHN", "TJK", "PRY", "TTO", "TTO", "TTO", "TTO", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU", "SAU"], "marker": {"color": [0.9903278350830078, 0.9258717894554138, 0.03301486372947693, 0.9802740812301636, 0.4777415096759796, 0.988888680934906, 0.988916277885437, 0.9819125533103943, 0.03735635429620743, 0.09942951053380966, 0.1228761076927185, 0.6797173619270325, 0.9803004860877991, 0.9903771281242371, 0.9902564883232117, 0.9763308167457581, 0.5212607383728027, 0.03808004409074783, 0.983282208442688, 0.9061954021453857, 0.31913211941719055, 0.9778064489364624, 0.9545751810073853, 0.9887194037437439, 0.9865584969520569, 0.9895386695861816, 0.3730819523334503, 0.9710715413093567, 0.9722254276275635, 0.9654565453529358, 0.988295316696167, 0.980549156665802, 0.8865543007850647, 0.8789016008377075, 0.6558321118354797, 0.9869552850723267, 0.9600448608398438, 0.013157621957361698, 0.02311776578426361, 0.9357139468193054, 0.013683650642633438, 0.08746157586574554, 0.09506958723068237, 0.020944947376847267, 0.9743028879165649, 0.9242598414421082, 0.9835892915725708, 0.01635131798684597, 0.013922506012022495, 0.9882948398590088, 0.9876456260681152, 0.9855538010597229, 0.044090647250413895, 0.9768977165222168, 0.9907414317131042, 0.9894940853118896, 0.5034304857254028, 0.985800564289093, 0.06235779821872711, 0.041487377136945724, 0.031916823238134384, 0.8965003490447998, 0.06193956732749939, 0.0769646167755127, 0.9639303088188171, 0.9729312658309937, 0.9886718392372131, 0.9904402494430542, 0.9876677989959717, 0.9875011444091797, 0.07457474619150162, 0.017027540132403374, 0.01653827354311943, 0.015336062759160995, 0.013809616677463055, 0.02052626945078373, 0.984883189201355, 0.9882239103317261, 0.9750896692276001, 0.9857234954833984, 0.986883819103241, 0.9907961487770081, 0.9904657006263733, 0.9904651045799255, 0.94557785987854, 0.02795945666730404, 0.988933801651001, 0.9875715374946594, 0.9839296936988831, 0.16088160872459412, 0.9724045991897583, 0.7853917479515076, 0.050770729780197144, 0.9587175250053406, 0.9811742305755615, 0.9204964637756348, 0.9218602180480957, 0.4246077239513397, 0.9843471646308899, 0.9902143478393555, 0.9862114787101746, 0.9234774708747864, 0.47251707315444946, 0.908193826675415, 0.9357872605323792, 0.9915353059768677, 0.9807658791542053, 0.03220202028751373, 0.9785273671150208, 0.9849993586540222, 0.9898694157600403, 0.04115939512848854, 0.9873039126396179, 0.34171801805496216, 0.987754225730896, 0.990883469581604, 0.02726256288588047, 0.9887055158615112, 0.8210367560386658, 0.5513240694999695, 0.8592293858528137, 0.9882355332374573, 0.8448930978775024, 0.9048131108283997, 0.8458470106124878, 0.7695845365524292, 0.5997339487075806, 0.9906385540962219, 0.9762527346611023, 0.9306373596191406, 0.9681133031845093, 0.9872229695320129, 0.01641753315925598, 0.09327973425388336, 0.9782524704933167, 0.9893156290054321, 0.22872819006443024, 0.8581562638282776, 0.5749895572662354, 0.9904399514198303, 0.4403957426548004, 0.9514491558074951, 0.8380817770957947, 0.9894313216209412, 0.4528568685054779, 0.6470261216163635, 0.9904924035072327, 0.08342763036489487, 0.8712990283966064, 0.9895274639129639, 0.9891878962516785, 0.9898216724395752, 0.973922610282898, 0.982810914516449, 0.9895809888839722, 0.9326935410499573, 0.41604411602020264, 0.1079876497387886, 0.9813465476036072, 0.44259113073349, 0.9865728616714478, 0.14630456268787384, 0.022688087075948715, 0.6051450967788696, 0.9885494112968445, 0.9883970022201538, 0.9752487540245056, 0.981093168258667, 0.9857863187789917, 0.9889436364173889, 0.3482884466648102, 0.9894099831581116, 0.9224351048469543, 0.957499623298645, 0.9899859428405762, 0.9263967275619507, 0.19556447863578796, 0.9844622611999512, 0.5421558022499084, 0.989896297454834, 0.9724631309509277, 0.29050108790397644, 0.7004779577255249, 0.017489515244960785, 0.9451194405555725, 0.22358523309230804, 0.9620206952095032, 0.9803941249847412, 0.9897805452346802, 0.9884350299835205, 0.6521075367927551, 0.5459848046302795, 0.8907711505889893, 0.11660991609096527, 0.02177281118929386, 0.5086423754692078, 0.9661024808883667, 0.9871200323104858, 0.021049384027719498, 0.9789365530014038, 0.9725486636161804, 0.9871951341629028, 0.9821212291717529, 0.9896422028541565, 0.019082145765423775, 0.07268048822879791, 0.5657462477684021, 0.02848239615559578, 0.954003632068634, 0.9791343212127686, 0.9785959124565125, 0.6985103487968445, 0.9887563586235046, 0.9569060802459717, 0.9728441834449768, 0.8787362575531006, 0.01714467629790306, 0.14665010571479797, 0.019065983593463898, 0.7969222664833069, 0.9172483086585999, 0.9638944864273071, 0.016521714627742767, 0.1396186798810959, 0.07040997594594955, 0.9627969861030579, 0.10718654096126556, 0.9899077415466309, 0.9653310775756836, 0.6278465390205383, 0.9722518920898438, 0.9892410039901733, 0.8594865202903748, 0.7541614174842834, 0.9824055433273315, 0.9892832636833191, 0.9703730344772339, 0.9867457747459412, 0.9610044956207275, 0.8763214349746704, 0.97705078125, 0.9904556274414062, 0.7856296896934509, 0.9755927324295044, 0.9868203997612, 0.9903814792633057, 0.6070419549942017, 0.9875897169113159, 0.990972101688385, 0.9893280267715454, 0.7920608520507812, 0.07353918254375458, 0.9891234040260315, 0.9841702580451965, 0.9080819487571716, 0.9899277687072754, 0.02817760407924652, 0.18510331213474274, 0.9840636253356934, 0.9019745588302612, 0.111836738884449, 0.9897711873054504, 0.2632521390914917, 0.9663383960723877, 0.9867244362831116, 0.27558693289756775, 0.9888103008270264, 0.9779835343360901, 0.8943707942962646, 0.22402574121952057, 0.9832348227500916, 0.92410808801651, 0.5349011421203613, 0.9881870150566101, 0.3195624351501465, 0.7518832087516785, 0.022225873544812202, 0.9785334467887878, 0.9814077615737915, 0.10552206635475159, 0.7685574293136597, 0.9160683751106262, 0.03128228336572647, 0.028210647404193878, 0.9715816974639893, 0.9877176880836487, 0.9851261377334595, 0.9744296073913574, 0.6378013491630554, 0.9760396480560303, 0.04848095029592514, 0.9292526841163635, 0.9885615706443787, 0.5763952136039734, 0.9883288145065308, 0.9605723023414612, 0.9302486181259155, 0.8821088075637817, 0.03185493126511574, 0.9795863628387451, 0.9626197814941406, 0.859560489654541, 0.3690294623374939, 0.9836251735687256, 0.26670095324516296, 0.9805530905723572, 0.7652795314788818, 0.3035966753959656, 0.9033697843551636, 0.09740804135799408, 0.8689233064651489, 0.052671194076538086, 0.324249267578125, 0.9902294278144836, 0.9858340620994568, 0.822955846786499, 0.9886311292648315, 0.9872759580612183, 0.9860461950302124, 0.4332980215549469, 0.5179227590560913, 0.021001407876610756, 0.12555627524852753, 0.2044258564710617, 0.13913187384605408, 0.017372457310557365, 0.14120616018772125, 0.9844555258750916, 0.08286195248365402, 0.98853999376297, 0.38979509472846985, 0.9315413236618042, 0.16674065589904785, 0.9857260584831238, 0.9912551641464233, 0.17524729669094086, 0.987005889415741, 0.9874380230903625, 0.9890842437744141, 0.9904338121414185, 0.9845537543296814, 0.9885907173156738, 0.892879843711853, 0.9875426292419434, 0.9855874180793762, 0.9880533814430237, 0.9901731014251709, 0.14228029549121857, 0.9894454479217529, 0.9803882241249084, 0.983103334903717, 0.9887873530387878, 0.9711689949035645, 0.9856598973274231, 0.9608017802238464, 0.22926226258277893, 0.9900932908058167, 0.988182008266449, 0.982263445854187, 0.9903508424758911, 0.9079728126525879, 0.989981472492218, 0.9888653755187988, 0.9834238886833191, 0.9639303088188171, 0.9729312658309937, 0.9886718392372131, 0.9904402494430542, 0.9876677989959717, 0.9875011444091797, 0.02007819153368473, 0.017027540132403374, 0.01653827354311943, 0.015336062759160995, 0.013809616677463055, 0.02052626945078373, 0.984883189201355, 0.9882239103317261, 0.9750896692276001, 0.9857234954833984, 0.986883819103241, 0.9907961487770081, 0.9904657006263733, 0.9904651045799255, 0.94557785987854, 0.9759677052497864, 0.9732282161712646, 0.9839574098587036, 0.9476821422576904, 0.8430238366127014, 0.9902473092079163, 0.9892764687538147, 0.46024397015571594, 0.039679937064647675, 0.8970088958740234, 0.052182309329509735, 0.9436042904853821, 0.4299856424331665, 0.05873885750770569, 0.7843363285064697, 0.14389130473136902, 0.7214798331260681, 0.9757146239280701, 0.9282270073890686, 0.4098474979400635, 0.9573317766189575, 0.9869728088378906, 0.7787234783172607, 0.15199494361877441, 0.8028212785720825, 0.7450935244560242, 0.9886122941970825, 0.9886592030525208, 0.023268839344382286, 0.022711927071213722, 0.9896419644355774, 0.22296933829784393, 0.9698293209075928, 0.03585207834839821, 0.9701481461524963, 0.9819139242172241, 0.8929833173751831, 0.8010050058364868, 0.9810172319412231, 0.8384777307510376, 0.9097244739532471, 0.9723595976829529, 0.9887194037437439, 0.01818050816655159, 0.6138487458229065, 0.897489607334137, 0.9873194694519043, 0.9876920580863953, 0.8577781319618225, 0.2589390277862549, 0.05890251323580742, 0.9695608019828796, 0.11756999790668488, 0.9811742305755615, 0.9204964637756348, 0.9218602180480957, 0.4246077239513397, 0.9843471646308899, 0.9902143478393555, 0.9862114787101746, 0.9234774708747864, 0.47251707315444946, 0.908193826675415, 0.9357872605323792, 0.9915353059768677, 0.9807658791542053, 0.03220202028751373, 0.9785273671150208, 0.9781305193901062, 0.9799166917800903, 0.028042038902640343, 0.7956790924072266, 0.8650113344192505, 0.6108077764511108, 0.023920297622680664, 0.9823033809661865, 0.9876580834388733, 0.952962338924408, 0.9889585375785828, 0.7129408121109009, 0.3124614655971527, 0.730099081993103, 0.9660577178001404, 0.03962785005569458, 0.3921063244342804, 0.05632935091853142, 0.7722805738449097, 0.989997148513794, 0.9885849356651306, 0.9882580041885376, 0.9807397723197937, 0.9875395894050598, 0.9537498950958252, 0.6519265174865723, 0.9879069924354553, 0.9859737753868103, 0.5179340839385986, 0.39931315183639526, 0.9817333817481995, 0.9894298315048218, 0.98477703332901, 0.8645102977752686, 0.15212339162826538, 0.9882342219352722, 0.016819925978779793, 0.9899340867996216, 0.989112377166748, 0.9717244505882263, 0.8660255670547485, 0.988137423992157, 0.9114149212837219, 0.9894125461578369, 0.42134547233581543, 0.17708182334899902, 0.7658159732818604, 0.10857371240854263, 0.7851555347442627, 0.1416555643081665, 0.9781354665756226, 0.8195919394493103, 0.6109755635261536, 0.05792050063610077, 0.9874544739723206, 0.9044705629348755, 0.9473594427108765, 0.10613187402486801, 0.9909771680831909, 0.9555771946907043, 0.9857863187789917, 0.9889436364173889, 0.3482884466648102, 0.9894099831581116, 0.9224351048469543, 0.957499623298645, 0.9899859428405762, 0.9263967275619507, 0.19556447863578796, 0.9844622611999512, 0.5421558022499084, 0.989896297454834, 0.022579455748200417, 0.509384036064148, 0.9887822270393372, 0.990574061870575, 0.18996986746788025, 0.9273965954780579, 0.06560828536748886, 0.8808094263076782, 0.5810150504112244, 0.9853407740592957, 0.9900805354118347, 0.9905087947845459, 0.9898239374160767, 0.889666736125946, 0.9860817790031433, 0.20969825983047485, 0.3729129731655121, 0.9854027032852173, 0.9694024920463562, 0.9899145364761353, 0.9909054040908813, 0.2721935510635376, 0.07115723937749863, 0.9778724312782288, 0.9670576453208923, 0.9865425229072571, 0.987371027469635, 0.03152240812778473, 0.986319899559021, 0.5847445130348206, 0.9883825778961182, 0.8917126059532166, 0.019772004336118698, 0.9904140830039978, 0.978605329990387, 0.8112959265708923, 0.9895926117897034, 0.7878127694129944, 0.9875370860099792, 0.276167094707489, 0.3002362549304962, 0.03154119476675987, 0.9904655814170837, 0.9913318753242493, 0.014283991418778896, 0.9903634190559387, 0.01352929137647152, 0.503432035446167, 0.980573832988739, 0.976589024066925, 0.989486575126648, 0.9789572954177856, 0.560180127620697, 0.9852286577224731, 0.05202796682715416, 0.9856074452400208, 0.08406779915094376, 0.848484456539154, 0.9856867790222168, 0.901435136795044, 0.9769334197044373, 0.044524043798446655, 0.9881206154823303, 0.40328317880630493, 0.964328408241272, 0.9901968240737915, 0.9906971454620361, 0.9890953302383423, 0.974462628364563, 0.14789660274982452, 0.4528540372848511, 0.8824478983879089, 0.8128299713134766, 0.04071880131959915, 0.9834302663803101, 0.7359244227409363, 0.8960778713226318, 0.023516902700066566, 0.19404922425746918, 0.08419648557901382, 0.9754515290260315, 0.08104553818702698, 0.9903993606567383, 0.017310334369540215, 0.05677559971809387, 0.02586757019162178, 0.02040805295109749, 0.017384855076670647, 0.012646062299609184, 0.9881511330604553, 0.5016931295394897, 0.3687368929386139, 0.02457474172115326, 0.9080262780189514, 0.08842717111110687, 0.9724220037460327, 0.15031620860099792, 0.7610234022140503, 0.1820565164089203, 0.9826421141624451, 0.1363835483789444, 0.5292624831199646, 0.9786518216133118, 0.0907529667019844, 0.07756438106298447, 0.8147468566894531, 0.9871329069137573, 0.9867480993270874, 0.16031873226165771, 0.9524646997451782, 0.987207293510437, 0.9799507856369019, 0.9349325299263, 0.8727374076843262, 0.578964352607727, 0.17514532804489136, 0.20400696992874146, 0.6723362803459167, 0.9873886704444885, 0.9884229898452759, 0.14808988571166992, 0.9887104630470276, 0.9822072982788086, 0.9872356653213501, 0.04707927629351616, 0.9814052581787109, 0.022020142525434494, 0.9872102737426758, 0.9795715808868408, 0.1434665024280548, 0.9272876977920532, 0.4709349274635315, 0.2355806529521942, 0.46343302726745605, 0.33750542998313904, 0.44548094272613525, 0.9872523546218872, 0.4302810728549957, 0.04728399217128754, 0.9741637110710144, 0.907549262046814, 0.020912369713187218, 0.022914208471775055, 0.388253390789032, 0.9827252626419067, 0.7623032927513123, 0.9665835499763489, 0.6512706875801086, 0.9562662243843079, 0.1313590109348297, 0.058946773409843445, 0.04018880054354668, 0.15563713014125824, 0.9240553975105286, 0.8070000410079956, 0.7771458625793457, 0.975493311882019, 0.7359195947647095, 0.6883528232574463, 0.21606793999671936, 0.019260838627815247, 0.7859871983528137, 0.01574852131307125, 0.8847048878669739, 0.9846776127815247, 0.9889479875564575, 0.025094997137784958, 0.9242598414421082, 0.9835892915725708, 0.01635131798684597, 0.013922506012022495, 0.9640732407569885, 0.9877225756645203, 0.13877533376216888, 0.4393870532512665, 0.9782152771949768, 0.9402454495429993, 0.9871259331703186, 0.9269280433654785, 0.9880780577659607, 0.256672203540802, 0.062082864344120026, 0.021666819229722023, 0.017571888864040375, 0.9355859160423279, 0.03229382261633873, 0.9822376370429993, 0.9373941421508789, 0.013868367299437523, 0.9007307887077332, 0.9873245358467102, 0.03544735535979271, 0.9639775156974792, 0.2399943470954895, 0.8890633583068848, 0.595383882522583, 0.9893636703491211, 0.08566228300333023, 0.044811468571424484, 0.9858337640762329, 0.9507176280021667, 0.983103334903717, 0.9887873530387878, 0.9711689949035645, 0.9856598973274231, 0.9608017802238464, 0.22926226258277893, 0.9900932908058167, 0.988182008266449, 0.982263445854187, 0.9903508424758911, 0.9079728126525879, 0.989981472492218, 0.9888653755187988, 0.9834238886833191, 0.9758360385894775, 0.9909006953239441, 0.9858178496360779, 0.7971238493919373, 0.9853962063789368, 0.03659089654684067, 0.9899695515632629, 0.9887212514877319, 0.9904050827026367, 0.9709647297859192, 0.977843701839447, 0.8883665204048157, 0.6371217966079712, 0.943855881690979, 0.9873794913291931, 0.9892082214355469, 0.9466489553451538, 0.9815812706947327, 0.9737735390663147, 0.4347488582134247, 0.9835785031318665, 0.8886511325836182, 0.9267269968986511, 0.9734275937080383, 0.8882107138633728, 0.9880711436271667, 0.8239160180091858, 0.19809207320213318, 0.5774911046028137, 0.019326025620102882, 0.024929992854595184, 0.4669252038002014, 0.21436481177806854, 0.9905490279197693, 0.9877080321311951, 0.8063652515411377, 0.9911335706710815, 0.9850022792816162, 0.7584715485572815, 0.2613803744316101, 0.9885401725769043, 0.08645455539226532, 0.9687811136245728, 0.026984691619873047, 0.9795407056808472, 0.4016317129135132, 0.9904619455337524, 0.05909982696175575, 0.9902268052101135, 0.5945145487785339, 0.9643102884292603, 0.9856909513473511, 0.6487022638320923, 0.9704917073249817, 0.9767587780952454, 0.7936412692070007, 0.9835706949234009, 0.9891948699951172, 0.0579475574195385, 0.9828832745552063, 0.9834128022193909, 0.41096287965774536, 0.0675944834947586, 0.07353918254375458, 0.9649674296379089, 0.9903460741043091, 0.4955957233905792, 0.9896215796470642, 0.9871959686279297, 0.9888815879821777, 0.5769312381744385, 0.7797951698303223, 0.49976325035095215, 0.9704691171646118, 0.803375244140625, 0.024510852992534637, 0.8138072490692139, 0.6603464484214783, 0.9903162121772766, 0.9741334915161133, 0.956796407699585, 0.9726621508598328, 0.9053788781166077, 0.16185635328292847, 0.027050675824284554, 0.4274677038192749, 0.043384213000535965, 0.8479809761047363, 0.6573129892349243, 0.9719684720039368, 0.9904764294624329, 0.9846212863922119, 0.07955542951822281, 0.984308123588562, 0.9893244504928589, 0.6794285774230957, 0.9882603883743286, 0.16638003289699554, 0.8782562017440796, 0.9869535565376282, 0.9884700179100037, 0.9541470408439636, 0.8901886940002441, 0.9896377325057983, 0.8762021064758301, 0.8000541925430298, 0.9879160523414612, 0.09631547331809998, 0.08588410168886185, 0.5615049004554749, 0.2913762032985687, 0.8302640914916992, 0.21056194603443146, 0.8463429808616638, 0.16841740906238556, 0.9802197217941284, 0.984642744064331, 0.9879260659217834, 0.9647554159164429, 0.01714467629790306, 0.14665010571479797, 0.019065983593463898, 0.7969222664833069, 0.9172483086585999, 0.9638944864273071, 0.016521714627742767, 0.1396186798810959, 0.07040997594594955, 0.9627969861030579, 0.10718654096126556, 0.9899077415466309, 0.9653310775756836, 0.6278465390205383, 0.9722518920898438, 0.9892410039901733, 0.15939156711101532, 0.9546576738357544, 0.8181811571121216, 0.01602996326982975, 0.16462914645671844, 0.8229138255119324, 0.9101958274841309, 0.0313139408826828, 0.01639704965054989, 0.8410821557044983, 0.5637220740318298, 0.3430420160293579, 0.433697372674942, 0.977927565574646, 0.14601784944534302, 0.21018020808696747, 0.43273797631263733, 0.37401512265205383, 0.9502963423728943, 0.987560510635376, 0.822955846786499, 0.9886311292648315, 0.9872759580612183, 0.9860461950302124, 0.4332980215549469, 0.5179227590560913, 0.021001407876610756, 0.12555627524852753, 0.2044258564710617, 0.13913187384605408, 0.017372457310557365, 0.14120616018772125, 0.9844555258750916, 0.08286195248365402, 0.98853999376297, 0.38979509472846985, 0.9315413236618042, 0.16674065589904785, 0.9857260584831238, 0.9912551641464233, 0.17524729669094086, 0.984144389629364, 0.9855290055274963, 0.9193755388259888, 0.9724627733230591, 0.7010658979415894, 0.15774005651474, 0.22546763718128204, 0.9402082562446594, 0.976028323173523, 0.9859723448753357, 0.9875497221946716, 0.986828088760376, 0.16622509062290192, 0.836868405342102, 0.9894653558731079, 0.8790926933288574, 0.7052581906318665, 0.9444901943206787, 0.9550608992576599, 0.9897828102111816, 0.97566157579422, 0.9295265078544617, 0.9376152157783508, 0.983517587184906, 0.8012567162513733, 0.32049819827079773, 0.9880966544151306, 0.7866527438163757, 0.986327588558197, 0.8559931516647339, 0.9825774431228638, 0.016153277829289436, 0.08676213771104813, 0.9892764687538147, 0.46024397015571594, 0.039679937064647675, 0.8970088958740234, 0.052182309329509735, 0.9436042904853821, 0.4299856424331665, 0.05873885750770569, 0.7843363285064697, 0.14389130473136902, 0.7214798331260681, 0.9757146239280701, 0.9282270073890686, 0.4098474979400635, 0.9573317766189575, 0.9869728088378906, 0.7787234783172607, 0.15199494361877441, 0.8634020686149597, 0.1129179447889328, 0.13670635223388672, 0.01629425399005413, 0.976590096950531, 0.9904043078422546, 0.9888054132461548, 0.9695947766304016, 0.8946252465248108, 0.06915779411792755, 0.9833933115005493, 0.9833025336265564, 0.9807903170585632, 0.6519265174865723, 0.9879069924354553, 0.9859737753868103, 0.5179340839385986, 0.39931315183639526, 0.9817333817481995, 0.9894298315048218, 0.98477703332901, 0.8645102977752686, 0.15212339162826538, 0.9882342219352722, 0.016819925978779793, 0.9899340867996216, 0.989112377166748, 0.9717244505882263, 0.8660255670547485, 0.988137423992157, 0.9114149212837219, 0.9894125461578369, 0.42134547233581543, 0.17708182334899902, 0.7658159732818604, 0.10857371240854263, 0.7851555347442627, 0.1416555643081665, 0.9710971713066101, 0.32647594809532166, 0.9894874095916748, 0.9835440516471863, 0.985260546207428, 0.8470490574836731, 0.4528540372848511, 0.8824478983879089, 0.8128299713134766, 0.04071880131959915, 0.9834302663803101, 0.7359244227409363, 0.8960778713226318, 0.023516902700066566, 0.19404922425746918, 0.08419648557901382, 0.9754515290260315, 0.08104553818702698, 0.9903993606567383, 0.017310334369540215, 0.05677559971809387, 0.02586757019162178, 0.02040805295109749, 0.017384855076670647, 0.012646062299609184, 0.9881511330604553, 0.5016931295394897, 0.3687368929386139, 0.02457474172115326, 0.9080262780189514, 0.08842717111110687, 0.9724220037460327, 0.15031620860099792, 0.7610234022140503, 0.1820565164089203, 0.9826421141624451, 0.1363835483789444, 0.5292624831199646], "coloraxis": "coloraxis"}, "name": "", "showlegend": false, "type": "scattergeo"}],
                        {"coloraxis": {"colorbar": {"title": {"text": "Predictions_Probas"}}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "geo": {"center": {}, "domain": {"x": [0.0, 1.0], "y": [0.0, 1.0]}, "projection": {"type": "natural earth"}, "resolution": 50}, "legend": {"tracegroupgap": 0}, "margin": {"t": 60}, "template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}},
                        {"responsive": true}
                    ).then(function(){
                            
var gd = document.getElementById('89bb0340-092e-4b1b-a377-dfe9270224ae');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })
                };
                
            </script>
        </div>
</body>
</html>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Future-improvements">Future improvements<a class="anchor-link" href="#Future-improvements"> </a></h1><p>ALBERT is indeed a very impressive language model. I'm looking forward to replicate the success <code>Albert</code> has on the Wikipedia dataset to news headlines scrapped from the web. However, there are added layers of complexity that needs to be solved:</p>
<ul>
<li><p>As explained earlier, we need to be able to differentiate facts from commentaries.</p>
</li>
<li><p>A simple Googling of "United States - China" relations might not return results that are all relevant. An added element of effort needs to be put in to clean the dataset.</p>
</li>
</ul>
<p>Like any data scientist would do, a deeper analysis of the results can be conducted by analysing the precision/recall on the test dataset.</p>
<p>That's it for now folks! If you have any questions/comments please feel free to reach out to me through <a href="https://www.linkedin.com/in/kennethwangtm/">Linkedin</a> or email at ken.wangtm@gmail.com</p>

</div>
</div>
</div>
</div>


  </div><a class="u-url" href="/fastpages/2020/03/07/_02_27_Geopolitical_Mapper.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/fastpages/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Kenneth Wang</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Kenneth Wang</li><li><a class="u-email" href="mailto:ken.wangtm@gmail.com">ken.wangtm@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list">
  <li><a href="https://github.com/kenneth-wang"><svg class="social svg-icon"><use xlink:href="/fastpages/assets/minima-social-icons.svg#github"></use></svg> <span class="username">kenneth-wang</span></a></li><li><a href="https://www.twitter.com/kenneth_wangg"><svg class="social svg-icon"><use xlink:href="/fastpages/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">kenneth_wangg</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>AI/ML Engineer (Apprentice) at AI Singapore.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
